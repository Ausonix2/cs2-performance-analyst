import{marked as de}from"https://esm.sh/marked@13.0.0";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))t(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&t(a)}).observe(document,{childList:!0,subtree:!0});function e(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function t(s){if(s.ep)return;s.ep=!0;const l=e(s);fetch(s.href,l)}})();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let ot,it;function st(){return{geminiUrl:ot,vertexUrl:it}}function rt(o,n,e){var t,s,l;if(!(!((t=o.httpOptions)===null||t===void 0)&&t.baseUrl)){const a=st();return o.vertexai?(s=a.vertexUrl)!==null&&s!==void 0?s:n:(l=a.geminiUrl)!==null&&l!==void 0?l:e}return o.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class K{}function T(o,n){const e=/\{([^}]+)\}/g;return o.replace(e,(t,s)=>{if(Object.prototype.hasOwnProperty.call(n,s)){const l=n[s];return l!=null?String(l):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function r(o,n,e){for(let l=0;l<n.length-1;l++){const a=n[l];if(a.endsWith("[]")){const u=a.slice(0,-2);if(!(u in o))if(Array.isArray(e))o[u]=Array.from({length:e.length},()=>({}));else throw new Error(`Value must be a list given an array path ${a}`);if(Array.isArray(o[u])){const c=o[u];if(Array.isArray(e))for(let d=0;d<c.length;d++){const f=c[d];r(f,n.slice(l+1),e[d])}else for(const d of c)r(d,n.slice(l+1),e)}return}else if(a.endsWith("[0]")){const u=a.slice(0,-3);u in o||(o[u]=[{}]);const c=o[u];r(c[0],n.slice(l+1),e);return}(!o[a]||typeof o[a]!="object")&&(o[a]={}),o=o[a]}const t=n[n.length-1],s=o[t];if(s!==void 0){if(!e||typeof e=="object"&&Object.keys(e).length===0||e===s)return;if(typeof s=="object"&&typeof e=="object"&&s!==null&&e!==null)Object.assign(s,e);else throw new Error(`Cannot set value for an existing key. Key: ${t}`)}else o[t]=e}function i(o,n){try{if(n.length===1&&n[0]==="_self")return o;for(let e=0;e<n.length;e++){if(typeof o!="object"||o===null)return;const t=n[e];if(t.endsWith("[]")){const s=t.slice(0,-2);if(s in o){const l=o[s];return Array.isArray(l)?l.map(a=>i(a,n.slice(e+1))):void 0}else return}else o=o[t]}return o}catch(e){if(e instanceof TypeError)return;throw e}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function I(o,n){if(!n||typeof n!="string")throw new Error("model is required and must be a string");if(o.isVertexAI()){if(n.startsWith("publishers/")||n.startsWith("projects/")||n.startsWith("models/"))return n;if(n.indexOf("/")>=0){const e=n.split("/",2);return`publishers/${e[0]}/models/${e[1]}`}else return`publishers/google/models/${n}`}else return n.startsWith("models/")||n.startsWith("tunedModels/")?n:`models/${n}`}function Un(o,n){const e=I(o,n);return e?e.startsWith("publishers/")&&o.isVertexAI()?`projects/${o.getProject()}/locations/${o.getLocation()}/${e}`:e.startsWith("models/")&&o.isVertexAI()?`projects/${o.getProject()}/locations/${o.getLocation()}/publishers/google/${e}`:e:""}function Fn(o,n){return Array.isArray(n)?n.map(e=>j(o,e)):[j(o,n)]}function j(o,n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function lt(o,n){const e=j(o,n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function at(o,n){const e=j(o,n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function xe(o,n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function kn(o,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>xe(o,e)):[xe(o,n)]}function ce(o){return o!=null&&typeof o=="object"&&"parts"in o&&Array.isArray(o.parts)}function Ne(o){return o!=null&&typeof o=="object"&&"functionCall"in o}function we(o){return o!=null&&typeof o=="object"&&"functionResponse"in o}function P(o,n){if(n==null)throw new Error("ContentUnion is required");return ce(n)?n:{role:"user",parts:kn(o,n)}}function qn(o,n){if(!n)return[];if(o.isVertexAI()&&Array.isArray(n))return n.flatMap(e=>{const t=P(o,e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]});if(o.isVertexAI()){const e=P(o,n);return e.parts&&e.parts.length>0&&e.parts[0].text!==void 0?[e.parts[0].text]:[]}return Array.isArray(n)?n.map(e=>P(o,e)):[P(o,n)]}function N(o,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(Ne(n)||we(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[P(o,n)]}const e=[],t=[],s=ce(n[0]);for(const l of n){const a=ce(l);if(a!=s)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)e.push(l);else{if(Ne(l)||we(l))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(l)}}return s||e.push({role:"user",parts:kn(o,t)}),e}function Gn(o,n){return n}function Bn(o,n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function oe(o,n){return n}function ie(o,n){if(!Array.isArray(n))throw new Error("tool is required and must be an array of Tools");return n}function ut(o,n,e,t=1){const s=!n.startsWith(`${e}/`)&&n.split("/").length===t;return o.isVertexAI()?n.startsWith("projects/")?n:n.startsWith("locations/")?`projects/${o.getProject()}/${n}`:n.startsWith(`${e}/`)?`projects/${o.getProject()}/locations/${o.getLocation()}/${n}`:s?`projects/${o.getProject()}/locations/${o.getLocation()}/${e}/${n}`:n:s?`${e}/${n}`:n}function w(o,n){if(typeof n!="string")throw new Error("name must be a string");return ut(o,n,"cachedContents")}function Hn(o,n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function L(o,n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}function dt(o){return o!=null&&typeof o=="object"&&"name"in o}function ct(o){return o!=null&&typeof o=="object"&&"video"in o}function ft(o){return o!=null&&typeof o=="object"&&"uri"in o}function Jn(o,n){var e;let t;if(dt(n)&&(t=n.name),!(ft(n)&&(t=n.uri,t===void 0))&&!(ct(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const l=t.split("files/")[1].match(/[a-z0-9]+/);if(l===null)throw new Error(`Could not extract file name from URI ${t}`);t=l[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function $n(o,n){let e;return o.isVertexAI()?e=n?"publishers/google/models":"models":e=n?"models":"tunedModels",e}function Yn(o,n){for(const e of["models","tunedModels","publisherModels"])if(pt(n,e))return n[e];return[]}function pt(o,n){return o!==null&&typeof o=="object"&&n in o}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function mt(o,n){const e={};if(i(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=i(n,["data"]);t!=null&&r(e,["data"],t);const s=i(n,["mimeType"]);return s!=null&&r(e,["mimeType"],s),e}function gt(o,n){const e={};if(i(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const t=i(n,["thought"]);t!=null&&r(e,["thought"],t);const s=i(n,["inlineData"]);s!=null&&r(e,["inlineData"],mt(o,s));const l=i(n,["codeExecutionResult"]);l!=null&&r(e,["codeExecutionResult"],l);const a=i(n,["executableCode"]);a!=null&&r(e,["executableCode"],a);const u=i(n,["fileData"]);u!=null&&r(e,["fileData"],u);const c=i(n,["functionCall"]);c!=null&&r(e,["functionCall"],c);const d=i(n,["functionResponse"]);d!=null&&r(e,["functionResponse"],d);const f=i(n,["text"]);return f!=null&&r(e,["text"],f),e}function Le(o,n){const e={},t=i(n,["parts"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(a=>gt(o,a))),r(e,["parts"],l)}const s=i(n,["role"]);return s!=null&&r(e,["role"],s),e}function ht(){return{}}function yt(o,n){const e={},t=i(n,["mode"]);t!=null&&r(e,["mode"],t);const s=i(n,["dynamicThreshold"]);return s!=null&&r(e,["dynamicThreshold"],s),e}function Tt(o,n){const e={},t=i(n,["dynamicRetrievalConfig"]);return t!=null&&r(e,["dynamicRetrievalConfig"],yt(o,t)),e}function Ct(o,n){const e={};if(i(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");i(n,["googleSearch"])!=null&&r(e,["googleSearch"],ht());const s=i(n,["googleSearchRetrieval"]);if(s!=null&&r(e,["googleSearchRetrieval"],Tt(o,s)),i(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(i(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=i(n,["codeExecution"]);l!=null&&r(e,["codeExecution"],l);const a=i(n,["functionDeclarations"]);return a!=null&&r(e,["functionDeclarations"],a),e}function Et(o,n){const e={},t=i(n,["mode"]);t!=null&&r(e,["mode"],t);const s=i(n,["allowedFunctionNames"]);return s!=null&&r(e,["allowedFunctionNames"],s),e}function vt(o,n){const e={},t=i(n,["functionCallingConfig"]);if(t!=null&&r(e,["functionCallingConfig"],Et(o,t)),i(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return e}function _t(o,n,e){const t={},s=i(n,["ttl"]);e!==void 0&&s!=null&&r(e,["ttl"],s);const l=i(n,["expireTime"]);e!==void 0&&l!=null&&r(e,["expireTime"],l);const a=i(n,["displayName"]);e!==void 0&&a!=null&&r(e,["displayName"],a);const u=i(n,["contents"]);if(e!==void 0&&u!=null){let p=N(o,u);Array.isArray(p)&&(p=p.map(m=>Le(o,m))),r(e,["contents"],p)}const c=i(n,["systemInstruction"]);e!==void 0&&c!=null&&r(e,["systemInstruction"],Le(o,P(o,c)));const d=i(n,["tools"]);if(e!==void 0&&d!=null){let p=d;Array.isArray(p)&&(p=p.map(m=>Ct(o,m))),r(e,["tools"],p)}const f=i(n,["toolConfig"]);return e!==void 0&&f!=null&&r(e,["toolConfig"],vt(o,f)),t}function It(o,n){const e={},t=i(n,["model"]);t!=null&&r(e,["model"],Un(o,t));const s=i(n,["config"]);return s!=null&&r(e,["config"],_t(o,s,e)),e}function St(o,n){const e={},t=i(n,["name"]);t!=null&&r(e,["_url","name"],w(o,t));const s=i(n,["config"]);return s!=null&&r(e,["config"],s),e}function At(o,n){const e={},t=i(n,["name"]);t!=null&&r(e,["_url","name"],w(o,t));const s=i(n,["config"]);return s!=null&&r(e,["config"],s),e}function Mt(o,n,e){const t={},s=i(n,["ttl"]);e!==void 0&&s!=null&&r(e,["ttl"],s);const l=i(n,["expireTime"]);return e!==void 0&&l!=null&&r(e,["expireTime"],l),t}function Pt(o,n){const e={},t=i(n,["name"]);t!=null&&r(e,["_url","name"],w(o,t));const s=i(n,["config"]);return s!=null&&r(e,["config"],Mt(o,s,e)),e}function Rt(o,n,e){const t={},s=i(n,["pageSize"]);e!==void 0&&s!=null&&r(e,["_query","pageSize"],s);const l=i(n,["pageToken"]);return e!==void 0&&l!=null&&r(e,["_query","pageToken"],l),t}function Dt(o,n){const e={},t=i(n,["config"]);return t!=null&&r(e,["config"],Rt(o,t,e)),e}function xt(o,n){const e={},t=i(n,["displayName"]);t!=null&&r(e,["displayName"],t);const s=i(n,["data"]);s!=null&&r(e,["data"],s);const l=i(n,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function Nt(o,n){const e={},t=i(n,["videoMetadata"]);t!=null&&r(e,["videoMetadata"],t);const s=i(n,["thought"]);s!=null&&r(e,["thought"],s);const l=i(n,["inlineData"]);l!=null&&r(e,["inlineData"],xt(o,l));const a=i(n,["codeExecutionResult"]);a!=null&&r(e,["codeExecutionResult"],a);const u=i(n,["executableCode"]);u!=null&&r(e,["executableCode"],u);const c=i(n,["fileData"]);c!=null&&r(e,["fileData"],c);const d=i(n,["functionCall"]);d!=null&&r(e,["functionCall"],d);const f=i(n,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const p=i(n,["text"]);return p!=null&&r(e,["text"],p),e}function Ve(o,n){const e={},t=i(n,["parts"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(a=>Nt(o,a))),r(e,["parts"],l)}const s=i(n,["role"]);return s!=null&&r(e,["role"],s),e}function wt(){return{}}function Lt(o,n){const e={},t=i(n,["mode"]);t!=null&&r(e,["mode"],t);const s=i(n,["dynamicThreshold"]);return s!=null&&r(e,["dynamicThreshold"],s),e}function Vt(o,n){const e={},t=i(n,["dynamicRetrievalConfig"]);return t!=null&&r(e,["dynamicRetrievalConfig"],Lt(o,t)),e}function Ut(){return{}}function Ft(o,n){const e={},t=i(n,["apiKeyString"]);return t!=null&&r(e,["apiKeyString"],t),e}function kt(o,n){const e={},t=i(n,["apiKeyConfig"]);t!=null&&r(e,["apiKeyConfig"],Ft(o,t));const s=i(n,["authType"]);s!=null&&r(e,["authType"],s);const l=i(n,["googleServiceAccountConfig"]);l!=null&&r(e,["googleServiceAccountConfig"],l);const a=i(n,["httpBasicAuthConfig"]);a!=null&&r(e,["httpBasicAuthConfig"],a);const u=i(n,["oauthConfig"]);u!=null&&r(e,["oauthConfig"],u);const c=i(n,["oidcConfig"]);return c!=null&&r(e,["oidcConfig"],c),e}function qt(o,n){const e={},t=i(n,["authConfig"]);return t!=null&&r(e,["authConfig"],kt(o,t)),e}function Gt(o,n){const e={},t=i(n,["retrieval"]);t!=null&&r(e,["retrieval"],t),i(n,["googleSearch"])!=null&&r(e,["googleSearch"],wt());const l=i(n,["googleSearchRetrieval"]);l!=null&&r(e,["googleSearchRetrieval"],Vt(o,l)),i(n,["enterpriseWebSearch"])!=null&&r(e,["enterpriseWebSearch"],Ut());const u=i(n,["googleMaps"]);u!=null&&r(e,["googleMaps"],qt(o,u));const c=i(n,["codeExecution"]);c!=null&&r(e,["codeExecution"],c);const d=i(n,["functionDeclarations"]);return d!=null&&r(e,["functionDeclarations"],d),e}function Bt(o,n){const e={},t=i(n,["mode"]);t!=null&&r(e,["mode"],t);const s=i(n,["allowedFunctionNames"]);return s!=null&&r(e,["allowedFunctionNames"],s),e}function Ht(o,n){const e={},t=i(n,["latitude"]);t!=null&&r(e,["latitude"],t);const s=i(n,["longitude"]);return s!=null&&r(e,["longitude"],s),e}function Jt(o,n){const e={},t=i(n,["latLng"]);return t!=null&&r(e,["latLng"],Ht(o,t)),e}function $t(o,n){const e={},t=i(n,["functionCallingConfig"]);t!=null&&r(e,["functionCallingConfig"],Bt(o,t));const s=i(n,["retrievalConfig"]);return s!=null&&r(e,["retrievalConfig"],Jt(o,s)),e}function Yt(o,n,e){const t={},s=i(n,["ttl"]);e!==void 0&&s!=null&&r(e,["ttl"],s);const l=i(n,["expireTime"]);e!==void 0&&l!=null&&r(e,["expireTime"],l);const a=i(n,["displayName"]);e!==void 0&&a!=null&&r(e,["displayName"],a);const u=i(n,["contents"]);if(e!==void 0&&u!=null){let p=N(o,u);Array.isArray(p)&&(p=p.map(m=>Ve(o,m))),r(e,["contents"],p)}const c=i(n,["systemInstruction"]);e!==void 0&&c!=null&&r(e,["systemInstruction"],Ve(o,P(o,c)));const d=i(n,["tools"]);if(e!==void 0&&d!=null){let p=d;Array.isArray(p)&&(p=p.map(m=>Gt(o,m))),r(e,["tools"],p)}const f=i(n,["toolConfig"]);return e!==void 0&&f!=null&&r(e,["toolConfig"],$t(o,f)),t}function Kt(o,n){const e={},t=i(n,["model"]);t!=null&&r(e,["model"],Un(o,t));const s=i(n,["config"]);return s!=null&&r(e,["config"],Yt(o,s,e)),e}function Wt(o,n){const e={},t=i(n,["name"]);t!=null&&r(e,["_url","name"],w(o,t));const s=i(n,["config"]);return s!=null&&r(e,["config"],s),e}function zt(o,n){const e={},t=i(n,["name"]);t!=null&&r(e,["_url","name"],w(o,t));const s=i(n,["config"]);return s!=null&&r(e,["config"],s),e}function bt(o,n,e){const t={},s=i(n,["ttl"]);e!==void 0&&s!=null&&r(e,["ttl"],s);const l=i(n,["expireTime"]);return e!==void 0&&l!=null&&r(e,["expireTime"],l),t}function Ot(o,n){const e={},t=i(n,["name"]);t!=null&&r(e,["_url","name"],w(o,t));const s=i(n,["config"]);return s!=null&&r(e,["config"],bt(o,s,e)),e}function Xt(o,n,e){const t={},s=i(n,["pageSize"]);e!==void 0&&s!=null&&r(e,["_query","pageSize"],s);const l=i(n,["pageToken"]);return e!==void 0&&l!=null&&r(e,["_query","pageToken"],l),t}function Zt(o,n){const e={},t=i(n,["config"]);return t!=null&&r(e,["config"],Xt(o,t,e)),e}function X(o,n){const e={},t=i(n,["name"]);t!=null&&r(e,["name"],t);const s=i(n,["displayName"]);s!=null&&r(e,["displayName"],s);const l=i(n,["model"]);l!=null&&r(e,["model"],l);const a=i(n,["createTime"]);a!=null&&r(e,["createTime"],a);const u=i(n,["updateTime"]);u!=null&&r(e,["updateTime"],u);const c=i(n,["expireTime"]);c!=null&&r(e,["expireTime"],c);const d=i(n,["usageMetadata"]);return d!=null&&r(e,["usageMetadata"],d),e}function Qt(){return{}}function jt(o,n){const e={},t=i(n,["nextPageToken"]);t!=null&&r(e,["nextPageToken"],t);const s=i(n,["cachedContents"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>X(o,a))),r(e,["cachedContents"],l)}return e}function Z(o,n){const e={},t=i(n,["name"]);t!=null&&r(e,["name"],t);const s=i(n,["displayName"]);s!=null&&r(e,["displayName"],s);const l=i(n,["model"]);l!=null&&r(e,["model"],l);const a=i(n,["createTime"]);a!=null&&r(e,["createTime"],a);const u=i(n,["updateTime"]);u!=null&&r(e,["updateTime"],u);const c=i(n,["expireTime"]);c!=null&&r(e,["expireTime"],c);const d=i(n,["usageMetadata"]);return d!=null&&r(e,["usageMetadata"],d),e}function eo(){return{}}function no(o,n){const e={},t=i(n,["nextPageToken"]);t!=null&&r(e,["nextPageToken"],t);const s=i(n,["cachedContents"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>Z(o,a))),r(e,["cachedContents"],l)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var F;(function(o){o.PAGED_ITEM_BATCH_JOBS="batchJobs",o.PAGED_ITEM_MODELS="models",o.PAGED_ITEM_TUNING_JOBS="tuningJobs",o.PAGED_ITEM_FILES="files",o.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(F||(F={}));class se{constructor(n,e,t,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=e,this.init(n,t,s)}init(n,e,t){var s,l;this.nameInternal=n,this.pageInternal=e[this.nameInternal]||[],this.idxInternal=0;let a={config:{}};t?typeof t=="object"?a=Object.assign({},t):a=t:a={config:{}},a.config&&(a.config.pageToken=e.nextPageToken),this.paramsInternal=a,this.pageInternalSize=(l=(s=a.config)===null||s===void 0?void 0:s.pageSize)!==null&&l!==void 0?l:this.pageInternal.length}initNextPage(n){this.init(this.nameInternal,n,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(n){return this.pageInternal[n]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const n=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:n,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const n=await this.requestInternal(this.params);return this.initNextPage(n),this.page}hasNextPage(){var n;return((n=this.params.config)===null||n===void 0?void 0:n.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ue;(function(o){o.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",o.OUTCOME_OK="OUTCOME_OK",o.OUTCOME_FAILED="OUTCOME_FAILED",o.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Ue||(Ue={}));var Fe;(function(o){o.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",o.PYTHON="PYTHON"})(Fe||(Fe={}));var ke;(function(o){o.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",o.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",o.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",o.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",o.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",o.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(ke||(ke={}));var qe;(function(o){o.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",o.SEVERITY="SEVERITY",o.PROBABILITY="PROBABILITY"})(qe||(qe={}));var Ge;(function(o){o.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",o.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",o.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",o.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",o.BLOCK_NONE="BLOCK_NONE",o.OFF="OFF"})(Ge||(Ge={}));var Be;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.MODE_DYNAMIC="MODE_DYNAMIC"})(Be||(Be={}));var He;(function(o){o.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",o.NO_AUTH="NO_AUTH",o.API_KEY_AUTH="API_KEY_AUTH",o.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",o.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",o.OAUTH="OAUTH",o.OIDC_AUTH="OIDC_AUTH"})(He||(He={}));var Je;(function(o){o.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",o.STRING="STRING",o.NUMBER="NUMBER",o.INTEGER="INTEGER",o.BOOLEAN="BOOLEAN",o.ARRAY="ARRAY",o.OBJECT="OBJECT"})(Je||(Je={}));var $e;(function(o){o.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",o.STOP="STOP",o.MAX_TOKENS="MAX_TOKENS",o.SAFETY="SAFETY",o.RECITATION="RECITATION",o.LANGUAGE="LANGUAGE",o.OTHER="OTHER",o.BLOCKLIST="BLOCKLIST",o.PROHIBITED_CONTENT="PROHIBITED_CONTENT",o.SPII="SPII",o.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",o.IMAGE_SAFETY="IMAGE_SAFETY"})($e||($e={}));var Ye;(function(o){o.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",o.NEGLIGIBLE="NEGLIGIBLE",o.LOW="LOW",o.MEDIUM="MEDIUM",o.HIGH="HIGH"})(Ye||(Ye={}));var Ke;(function(o){o.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",o.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",o.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",o.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",o.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Ke||(Ke={}));var We;(function(o){o.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",o.SAFETY="SAFETY",o.OTHER="OTHER",o.BLOCKLIST="BLOCKLIST",o.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(We||(We={}));var ze;(function(o){o.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",o.ON_DEMAND="ON_DEMAND",o.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(ze||(ze={}));var ee;(function(o){o.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",o.TEXT="TEXT",o.IMAGE="IMAGE",o.AUDIO="AUDIO"})(ee||(ee={}));var be;(function(o){o.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",o.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",o.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",o.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(be||(be={}));var fe;(function(o){o.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",o.JOB_STATE_QUEUED="JOB_STATE_QUEUED",o.JOB_STATE_PENDING="JOB_STATE_PENDING",o.JOB_STATE_RUNNING="JOB_STATE_RUNNING",o.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",o.JOB_STATE_FAILED="JOB_STATE_FAILED",o.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",o.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",o.JOB_STATE_PAUSED="JOB_STATE_PAUSED",o.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",o.JOB_STATE_UPDATING="JOB_STATE_UPDATING",o.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(fe||(fe={}));var Oe;(function(o){o.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",o.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",o.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",o.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",o.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",o.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",o.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Oe||(Oe={}));var Xe;(function(o){o.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",o.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",o.BALANCED="BALANCED",o.PRIORITIZE_COST="PRIORITIZE_COST"})(Xe||(Xe={}));var Ze;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.MODE_DYNAMIC="MODE_DYNAMIC"})(Ze||(Ze={}));var Qe;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.AUTO="AUTO",o.ANY="ANY",o.NONE="NONE"})(Qe||(Qe={}));var je;(function(o){o.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",o.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",o.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",o.BLOCK_NONE="BLOCK_NONE"})(je||(je={}));var en;(function(o){o.DONT_ALLOW="DONT_ALLOW",o.ALLOW_ADULT="ALLOW_ADULT",o.ALLOW_ALL="ALLOW_ALL"})(en||(en={}));var nn;(function(o){o.auto="auto",o.en="en",o.ja="ja",o.ko="ko",o.hi="hi"})(nn||(nn={}));var tn;(function(o){o.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",o.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",o.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",o.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",o.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(tn||(tn={}));var on;(function(o){o.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",o.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",o.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",o.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(on||(on={}));var sn;(function(o){o.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",o.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",o.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",o.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(sn||(sn={}));var rn;(function(o){o.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",o.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",o.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",o.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",o.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",o.EDIT_MODE_STYLE="EDIT_MODE_STYLE",o.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",o.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(rn||(rn={}));var ln;(function(o){o.STATE_UNSPECIFIED="STATE_UNSPECIFIED",o.PROCESSING="PROCESSING",o.ACTIVE="ACTIVE",o.FAILED="FAILED"})(ln||(ln={}));var an;(function(o){o.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",o.UPLOADED="UPLOADED",o.GENERATED="GENERATED"})(an||(an={}));var un;(function(o){o.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",o.TEXT="TEXT",o.IMAGE="IMAGE",o.VIDEO="VIDEO",o.AUDIO="AUDIO",o.DOCUMENT="DOCUMENT"})(un||(un={}));var dn;(function(o){o.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",o.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",o.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(dn||(dn={}));var cn;(function(o){o.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",o.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",o.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(cn||(cn={}));var fn;(function(o){o.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",o.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",o.NO_INTERRUPTION="NO_INTERRUPTION"})(fn||(fn={}));var pn;(function(o){o.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",o.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",o.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(pn||(pn={}));class W{get text(){var n,e,t,s,l,a,u,c;if(((s=(t=(e=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||e===void 0?void 0:e.content)===null||t===void 0?void 0:t.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",f=!1;const p=[];for(const m of(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)!==null&&c!==void 0?c:[]){for(const[g,h]of Object.entries(m))g!=="text"&&g!=="thought"&&(h!==null||h!==void 0)&&p.push(g);if(typeof m.text=="string"){if(typeof m.thought=="boolean"&&m.thought)continue;f=!0,d+=m.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?d:void 0}get data(){var n,e,t,s,l,a,u,c;if(((s=(t=(e=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||e===void 0?void 0:e.content)===null||t===void 0?void 0:t.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const f=[];for(const p of(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)!==null&&c!==void 0?c:[]){for(const[m,g]of Object.entries(p))m!=="inlineData"&&(g!==null||g!==void 0)&&f.push(m);p.inlineData&&typeof p.inlineData.data=="string"&&(d+=atob(p.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var n,e,t,s,l,a,u,c;if(((s=(t=(e=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||e===void 0?void 0:e.content)===null||t===void 0?void 0:t.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((d==null?void 0:d.length)!==0)return d}get executableCode(){var n,e,t,s,l,a,u,c,d;if(((s=(t=(e=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||e===void 0?void 0:e.content)===null||t===void 0?void 0:t.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(d=f==null?void 0:f[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var n,e,t,s,l,a,u,c,d;if(((s=(t=(e=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||e===void 0?void 0:e.content)===null||t===void 0?void 0:t.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(d=f==null?void 0:f[0])===null||d===void 0?void 0:d.output}}class mn{}class gn{}class to{}class oo{}class hn{}class yn{}class Tn{}class io{}class Cn{}class En{}class vn{}class so{}class pe{constructor(n){const e={};for(const t of n.headers.entries())e[t[0]]=t[1];this.headers=e,this.responseInternal=n}json(){return this.responseInternal.json()}}class ro{}class lo{}class ao{get text(){var n,e,t;let s="",l=!1;const a=[];for(const u of(t=(e=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||e===void 0?void 0:e.parts)!==null&&t!==void 0?t:[]){for(const[c,d]of Object.entries(u))c!=="text"&&c!=="thought"&&d!==null&&a.push(c);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;l=!0,s+=u.text}}return a.length>0&&console.warn(`there are non-text parts ${a} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?s:void 0}get data(){var n,e,t;let s="";const l=[];for(const a of(t=(e=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||e===void 0?void 0:e.parts)!==null&&t!==void 0?t:[]){for(const[u,c]of Object.entries(a))u!=="inlineData"&&c!==null&&l.push(u);a.inlineData&&typeof a.inlineData.data=="string"&&(s+=atob(a.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class uo extends K{constructor(n){super(),this.apiClient=n,this.list=async(e={})=>new se(F.PAGED_ITEM_CACHED_CONTENTS,t=>this.listInternal(t),await this.listInternal(e),e)}async create(n){var e,t,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Kt(this.apiClient,n);return u=T("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(f=>f.json()),a.then(f=>Z(this.apiClient,f))}else{const d=It(this.apiClient,n);return u=T("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>X(this.apiClient,f))}}async get(n){var e,t,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Wt(this.apiClient,n);return u=T("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(f=>f.json()),a.then(f=>Z(this.apiClient,f))}else{const d=St(this.apiClient,n);return u=T("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>X(this.apiClient,f))}}async delete(n){var e,t,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=zt(this.apiClient,n);return u=T("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(f=>f.json()),a.then(()=>{const f=eo(),p=new En;return Object.assign(p,f),p})}else{const d=At(this.apiClient,n);return u=T("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(()=>{const f=Qt(),p=new En;return Object.assign(p,f),p})}}async update(n){var e,t,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Ot(this.apiClient,n);return u=T("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(f=>f.json()),a.then(f=>Z(this.apiClient,f))}else{const d=Pt(this.apiClient,n);return u=T("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>X(this.apiClient,f))}}async listInternal(n){var e,t,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Zt(this.apiClient,n);return u=T("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(f=>f.json()),a.then(f=>{const p=no(this.apiClient,f),m=new vn;return Object.assign(m,p),m})}else{const d=Dt(this.apiClient,n);return u=T("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=jt(this.apiClient,f),m=new vn;return Object.assign(m,p),m})}}}function _n(o){var n=typeof Symbol=="function"&&Symbol.iterator,e=n&&o[n],t=0;if(e)return e.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&t>=o.length&&(o=void 0),{value:o&&o[t++],done:!o}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function M(o){return this instanceof M?(this.v=o,this):new M(o)}function ne(o,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e.apply(o,n||[]),s,l=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",a),s[Symbol.asyncIterator]=function(){return this},s;function a(g){return function(h){return Promise.resolve(h).then(g,p)}}function u(g,h){t[g]&&(s[g]=function(y){return new Promise(function(C,v){l.push([g,y,C,v])>1||c(g,y)})},h&&(s[g]=h(s[g])))}function c(g,h){try{d(t[g](h))}catch(y){m(l[0][3],y)}}function d(g){g.value instanceof M?Promise.resolve(g.value.v).then(f,p):m(l[0][2],g)}function f(g){c("next",g)}function p(g){c("throw",g)}function m(g,h){g(h),l.shift(),l.length&&c(l[0][0],l[0][1])}}function me(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=o[Symbol.asyncIterator],e;return n?n.call(o):(o=typeof _n=="function"?_n(o):o[Symbol.iterator](),e={},t("next"),t("throw"),t("return"),e[Symbol.asyncIterator]=function(){return this},e);function t(l){e[l]=o[l]&&function(a){return new Promise(function(u,c){a=o[l](a),s(u,c,a.done,a.value)})}}function s(l,a,u,c){Promise.resolve(c).then(function(d){l({value:d,done:u})},a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function co(o){var n;if(o.candidates==null||o.candidates.length===0)return!1;const e=(n=o.candidates[0])===null||n===void 0?void 0:n.content;return e===void 0?!1:Kn(e)}function Kn(o){if(o.parts===void 0||o.parts.length===0)return!1;for(const n of o.parts)if(n===void 0||Object.keys(n).length===0||n.text!==void 0&&n.text==="")return!1;return!0}function fo(o){if(o.length!==0){if(o[0].role!=="user")throw new Error("History must start with a user turn.");for(const n of o)if(n.role!=="user"&&n.role!=="model")throw new Error(`Role must be user or model, but got ${n.role}.`)}}function po(o){if(o===void 0||o.length===0)return[];const n=[],e=o.length;let t=0,s=o[0];for(;t<e;)if(o[t].role==="user")s=o[t],t++;else{const l=[];let a=!0;for(;t<e&&o[t].role==="model";)l.push(o[t]),a&&!Kn(o[t])&&(a=!1),t++;a&&(n.push(s),n.push(...l))}return n}class mo{constructor(n,e){this.modelsModule=n,this.apiClient=e}create(n){return new go(this.apiClient,this.modelsModule,n.model,n.config,n.history)}}class go{constructor(n,e,t,s={},l=[]){this.apiClient=n,this.modelsModule=e,this.model=t,this.config=s,this.history=l,this.sendPromise=Promise.resolve(),fo(l)}async sendMessage(n){var e;await this.sendPromise;const t=P(this.apiClient,n.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(t),config:(e=n.config)!==null&&e!==void 0?e:this.config});return this.sendPromise=(async()=>{var l,a;const c=(a=(l=(await s).candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content,d=c?[c]:[];this.recordHistory(t,d)})(),await this.sendPromise,s}async sendMessageStream(n){var e;await this.sendPromise;const t=P(this.apiClient,n.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(t),config:(e=n.config)!==null&&e!==void 0?e:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const l=await s;return this.processStreamResponse(l,t)}getHistory(n=!1){return n?po(this.history):this.history}processStreamResponse(n,e){var t,s;return ne(this,arguments,function*(){var a,u,c,d;const f=[];try{for(var p=!0,m=me(n),g;g=yield M(m.next()),a=g.done,!a;p=!0){d=g.value,p=!1;const h=d;if(co(h)){const y=(s=(t=h.candidates)===null||t===void 0?void 0:t[0])===null||s===void 0?void 0:s.content;y!==void 0&&f.push(y)}yield yield M(h)}}catch(h){u={error:h}}finally{try{!p&&!a&&(c=m.return)&&(yield M(c.call(m)))}finally{if(u)throw u.error}}this.recordHistory(e,f)})}recordHistory(n,e){let t=[];e.length>0&&e.every(s=>s.role==="model")?t=e:t.push({role:"model",parts:[]}),this.history.push(n),this.history.push(...t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ho(o,n,e){const t={},s=i(n,["pageSize"]);e!==void 0&&s!=null&&r(e,["_query","pageSize"],s);const l=i(n,["pageToken"]);return e!==void 0&&l!=null&&r(e,["_query","pageToken"],l),t}function yo(o,n){const e={},t=i(n,["config"]);return t!=null&&r(e,["config"],ho(o,t,e)),e}function To(o,n){const e={},t=i(n,["details"]);t!=null&&r(e,["details"],t);const s=i(n,["message"]);s!=null&&r(e,["message"],s);const l=i(n,["code"]);return l!=null&&r(e,["code"],l),e}function Co(o,n){const e={},t=i(n,["name"]);t!=null&&r(e,["name"],t);const s=i(n,["displayName"]);s!=null&&r(e,["displayName"],s);const l=i(n,["mimeType"]);l!=null&&r(e,["mimeType"],l);const a=i(n,["sizeBytes"]);a!=null&&r(e,["sizeBytes"],a);const u=i(n,["createTime"]);u!=null&&r(e,["createTime"],u);const c=i(n,["expirationTime"]);c!=null&&r(e,["expirationTime"],c);const d=i(n,["updateTime"]);d!=null&&r(e,["updateTime"],d);const f=i(n,["sha256Hash"]);f!=null&&r(e,["sha256Hash"],f);const p=i(n,["uri"]);p!=null&&r(e,["uri"],p);const m=i(n,["downloadUri"]);m!=null&&r(e,["downloadUri"],m);const g=i(n,["state"]);g!=null&&r(e,["state"],g);const h=i(n,["source"]);h!=null&&r(e,["source"],h);const y=i(n,["videoMetadata"]);y!=null&&r(e,["videoMetadata"],y);const C=i(n,["error"]);return C!=null&&r(e,["error"],To(o,C)),e}function Eo(o,n){const e={},t=i(n,["file"]);t!=null&&r(e,["file"],Co(o,t));const s=i(n,["config"]);return s!=null&&r(e,["config"],s),e}function vo(o,n){const e={},t=i(n,["name"]);t!=null&&r(e,["_url","file"],Jn(o,t));const s=i(n,["config"]);return s!=null&&r(e,["config"],s),e}function _o(o,n){const e={},t=i(n,["name"]);t!=null&&r(e,["_url","file"],Jn(o,t));const s=i(n,["config"]);return s!=null&&r(e,["config"],s),e}function Io(o,n){const e={},t=i(n,["details"]);t!=null&&r(e,["details"],t);const s=i(n,["message"]);s!=null&&r(e,["message"],s);const l=i(n,["code"]);return l!=null&&r(e,["code"],l),e}function ge(o,n){const e={},t=i(n,["name"]);t!=null&&r(e,["name"],t);const s=i(n,["displayName"]);s!=null&&r(e,["displayName"],s);const l=i(n,["mimeType"]);l!=null&&r(e,["mimeType"],l);const a=i(n,["sizeBytes"]);a!=null&&r(e,["sizeBytes"],a);const u=i(n,["createTime"]);u!=null&&r(e,["createTime"],u);const c=i(n,["expirationTime"]);c!=null&&r(e,["expirationTime"],c);const d=i(n,["updateTime"]);d!=null&&r(e,["updateTime"],d);const f=i(n,["sha256Hash"]);f!=null&&r(e,["sha256Hash"],f);const p=i(n,["uri"]);p!=null&&r(e,["uri"],p);const m=i(n,["downloadUri"]);m!=null&&r(e,["downloadUri"],m);const g=i(n,["state"]);g!=null&&r(e,["state"],g);const h=i(n,["source"]);h!=null&&r(e,["source"],h);const y=i(n,["videoMetadata"]);y!=null&&r(e,["videoMetadata"],y);const C=i(n,["error"]);return C!=null&&r(e,["error"],Io(o,C)),e}function So(o,n){const e={},t=i(n,["nextPageToken"]);t!=null&&r(e,["nextPageToken"],t);const s=i(n,["files"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>ge(o,a))),r(e,["files"],l)}return e}function Ao(){return{}}function Mo(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Po extends K{constructor(n){super(),this.apiClient=n,this.list=async(e={})=>new se(F.PAGED_ITEM_FILES,t=>this.listInternal(t),await this.listInternal(e),e)}async upload(n){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(n.file,n.config).then(e=>ge(this.apiClient,e))}async download(n){await this.apiClient.downloadFile(n)}async listInternal(n){var e,t;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=yo(this.apiClient,n);return l=T("files",u._url),a=u._query,delete u.config,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(c=>c.json()),s.then(c=>{const d=So(this.apiClient,c),f=new so;return Object.assign(f,d),f})}}async createInternal(n){var e,t;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Eo(this.apiClient,n);return l=T("upload/v1beta/files",u._url),a=u._query,delete u.config,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(c=>c.json()),s.then(()=>{const c=Ao(),d=new ro;return Object.assign(d,c),d})}}async get(n){var e,t;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=vo(this.apiClient,n);return l=T("files/{file}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(c=>c.json()),s.then(c=>ge(this.apiClient,c))}}async delete(n){var e,t;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=_o(this.apiClient,n);return l=T("files/{file}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(c=>c.json()),s.then(()=>{const c=Mo(),d=new lo;return Object.assign(d,c),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ro(o,n){const e={};if(i(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=i(n,["data"]);t!=null&&r(e,["data"],t);const s=i(n,["mimeType"]);return s!=null&&r(e,["mimeType"],s),e}function Do(o,n){const e={},t=i(n,["displayName"]);t!=null&&r(e,["displayName"],t);const s=i(n,["data"]);s!=null&&r(e,["data"],s);const l=i(n,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function xo(o,n){const e={};if(i(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const t=i(n,["thought"]);t!=null&&r(e,["thought"],t);const s=i(n,["inlineData"]);s!=null&&r(e,["inlineData"],Ro(o,s));const l=i(n,["codeExecutionResult"]);l!=null&&r(e,["codeExecutionResult"],l);const a=i(n,["executableCode"]);a!=null&&r(e,["executableCode"],a);const u=i(n,["fileData"]);u!=null&&r(e,["fileData"],u);const c=i(n,["functionCall"]);c!=null&&r(e,["functionCall"],c);const d=i(n,["functionResponse"]);d!=null&&r(e,["functionResponse"],d);const f=i(n,["text"]);return f!=null&&r(e,["text"],f),e}function No(o,n){const e={},t=i(n,["videoMetadata"]);t!=null&&r(e,["videoMetadata"],t);const s=i(n,["thought"]);s!=null&&r(e,["thought"],s);const l=i(n,["inlineData"]);l!=null&&r(e,["inlineData"],Do(o,l));const a=i(n,["codeExecutionResult"]);a!=null&&r(e,["codeExecutionResult"],a);const u=i(n,["executableCode"]);u!=null&&r(e,["executableCode"],u);const c=i(n,["fileData"]);c!=null&&r(e,["fileData"],c);const d=i(n,["functionCall"]);d!=null&&r(e,["functionCall"],d);const f=i(n,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const p=i(n,["text"]);return p!=null&&r(e,["text"],p),e}function wo(o,n){const e={},t=i(n,["parts"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(a=>xo(o,a))),r(e,["parts"],l)}const s=i(n,["role"]);return s!=null&&r(e,["role"],s),e}function Lo(o,n){const e={},t=i(n,["parts"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(a=>No(o,a))),r(e,["parts"],l)}const s=i(n,["role"]);return s!=null&&r(e,["role"],s),e}function Vo(){return{}}function Uo(){return{}}function Fo(o,n){const e={},t=i(n,["mode"]);t!=null&&r(e,["mode"],t);const s=i(n,["dynamicThreshold"]);return s!=null&&r(e,["dynamicThreshold"],s),e}function ko(o,n){const e={},t=i(n,["mode"]);t!=null&&r(e,["mode"],t);const s=i(n,["dynamicThreshold"]);return s!=null&&r(e,["dynamicThreshold"],s),e}function qo(o,n){const e={},t=i(n,["dynamicRetrievalConfig"]);return t!=null&&r(e,["dynamicRetrievalConfig"],Fo(o,t)),e}function Go(o,n){const e={},t=i(n,["dynamicRetrievalConfig"]);return t!=null&&r(e,["dynamicRetrievalConfig"],ko(o,t)),e}function Bo(){return{}}function Ho(o,n){const e={},t=i(n,["apiKeyString"]);return t!=null&&r(e,["apiKeyString"],t),e}function Jo(o,n){const e={},t=i(n,["apiKeyConfig"]);t!=null&&r(e,["apiKeyConfig"],Ho(o,t));const s=i(n,["authType"]);s!=null&&r(e,["authType"],s);const l=i(n,["googleServiceAccountConfig"]);l!=null&&r(e,["googleServiceAccountConfig"],l);const a=i(n,["httpBasicAuthConfig"]);a!=null&&r(e,["httpBasicAuthConfig"],a);const u=i(n,["oauthConfig"]);u!=null&&r(e,["oauthConfig"],u);const c=i(n,["oidcConfig"]);return c!=null&&r(e,["oidcConfig"],c),e}function $o(o,n){const e={},t=i(n,["authConfig"]);return t!=null&&r(e,["authConfig"],Jo(o,t)),e}function Yo(o,n){const e={};if(i(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");i(n,["googleSearch"])!=null&&r(e,["googleSearch"],Vo());const s=i(n,["googleSearchRetrieval"]);if(s!=null&&r(e,["googleSearchRetrieval"],qo(o,s)),i(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(i(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=i(n,["codeExecution"]);l!=null&&r(e,["codeExecution"],l);const a=i(n,["functionDeclarations"]);return a!=null&&r(e,["functionDeclarations"],a),e}function Ko(o,n){const e={},t=i(n,["retrieval"]);t!=null&&r(e,["retrieval"],t),i(n,["googleSearch"])!=null&&r(e,["googleSearch"],Uo());const l=i(n,["googleSearchRetrieval"]);l!=null&&r(e,["googleSearchRetrieval"],Go(o,l)),i(n,["enterpriseWebSearch"])!=null&&r(e,["enterpriseWebSearch"],Bo());const u=i(n,["googleMaps"]);u!=null&&r(e,["googleMaps"],$o(o,u));const c=i(n,["codeExecution"]);c!=null&&r(e,["codeExecution"],c);const d=i(n,["functionDeclarations"]);return d!=null&&r(e,["functionDeclarations"],d),e}function Wo(o,n){const e={},t=i(n,["handle"]);if(t!=null&&r(e,["handle"],t),i(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function zo(o,n){const e={},t=i(n,["handle"]);t!=null&&r(e,["handle"],t);const s=i(n,["transparent"]);return s!=null&&r(e,["transparent"],s),e}function In(){return{}}function Sn(){return{}}function bo(o,n){const e={},t=i(n,["disabled"]);t!=null&&r(e,["disabled"],t);const s=i(n,["startOfSpeechSensitivity"]);s!=null&&r(e,["startOfSpeechSensitivity"],s);const l=i(n,["endOfSpeechSensitivity"]);l!=null&&r(e,["endOfSpeechSensitivity"],l);const a=i(n,["prefixPaddingMs"]);a!=null&&r(e,["prefixPaddingMs"],a);const u=i(n,["silenceDurationMs"]);return u!=null&&r(e,["silenceDurationMs"],u),e}function Oo(o,n){const e={},t=i(n,["disabled"]);t!=null&&r(e,["disabled"],t);const s=i(n,["startOfSpeechSensitivity"]);s!=null&&r(e,["startOfSpeechSensitivity"],s);const l=i(n,["endOfSpeechSensitivity"]);l!=null&&r(e,["endOfSpeechSensitivity"],l);const a=i(n,["prefixPaddingMs"]);a!=null&&r(e,["prefixPaddingMs"],a);const u=i(n,["silenceDurationMs"]);return u!=null&&r(e,["silenceDurationMs"],u),e}function Xo(o,n){const e={},t=i(n,["automaticActivityDetection"]);t!=null&&r(e,["automaticActivityDetection"],bo(o,t));const s=i(n,["activityHandling"]);s!=null&&r(e,["activityHandling"],s);const l=i(n,["turnCoverage"]);return l!=null&&r(e,["turnCoverage"],l),e}function Zo(o,n){const e={},t=i(n,["automaticActivityDetection"]);t!=null&&r(e,["automaticActivityDetection"],Oo(o,t));const s=i(n,["activityHandling"]);s!=null&&r(e,["activityHandling"],s);const l=i(n,["turnCoverage"]);return l!=null&&r(e,["turnCoverage"],l),e}function Qo(o,n){const e={},t=i(n,["targetTokens"]);return t!=null&&r(e,["targetTokens"],t),e}function jo(o,n){const e={},t=i(n,["targetTokens"]);return t!=null&&r(e,["targetTokens"],t),e}function ei(o,n){const e={},t=i(n,["triggerTokens"]);t!=null&&r(e,["triggerTokens"],t);const s=i(n,["slidingWindow"]);return s!=null&&r(e,["slidingWindow"],Qo(o,s)),e}function ni(o,n){const e={},t=i(n,["triggerTokens"]);t!=null&&r(e,["triggerTokens"],t);const s=i(n,["slidingWindow"]);return s!=null&&r(e,["slidingWindow"],jo(o,s)),e}function ti(o,n,e){const t={},s=i(n,["generationConfig"]);e!==void 0&&s!=null&&r(e,["setup","generationConfig"],s);const l=i(n,["responseModalities"]);e!==void 0&&l!=null&&r(e,["setup","generationConfig","responseModalities"],l);const a=i(n,["temperature"]);e!==void 0&&a!=null&&r(e,["setup","generationConfig","temperature"],a);const u=i(n,["topP"]);e!==void 0&&u!=null&&r(e,["setup","generationConfig","topP"],u);const c=i(n,["topK"]);e!==void 0&&c!=null&&r(e,["setup","generationConfig","topK"],c);const d=i(n,["maxOutputTokens"]);e!==void 0&&d!=null&&r(e,["setup","generationConfig","maxOutputTokens"],d);const f=i(n,["mediaResolution"]);e!==void 0&&f!=null&&r(e,["setup","generationConfig","mediaResolution"],f);const p=i(n,["seed"]);e!==void 0&&p!=null&&r(e,["setup","generationConfig","seed"],p);const m=i(n,["speechConfig"]);e!==void 0&&m!=null&&r(e,["setup","generationConfig","speechConfig"],m);const g=i(n,["systemInstruction"]);e!==void 0&&g!=null&&r(e,["setup","systemInstruction"],wo(o,P(o,g)));const h=i(n,["tools"]);if(e!==void 0&&h!=null){let E=ie(o,h);Array.isArray(E)&&(E=E.map(A=>Yo(o,oe(o,A)))),r(e,["setup","tools"],E)}const y=i(n,["sessionResumption"]);e!==void 0&&y!=null&&r(e,["setup","sessionResumption"],Wo(o,y));const C=i(n,["inputAudioTranscription"]);e!==void 0&&C!=null&&r(e,["setup","inputAudioTranscription"],In());const v=i(n,["outputAudioTranscription"]);e!==void 0&&v!=null&&r(e,["setup","outputAudioTranscription"],In());const _=i(n,["realtimeInputConfig"]);e!==void 0&&_!=null&&r(e,["setup","realtimeInputConfig"],Xo(o,_));const S=i(n,["contextWindowCompression"]);return e!==void 0&&S!=null&&r(e,["setup","contextWindowCompression"],ei(o,S)),t}function oi(o,n,e){const t={},s=i(n,["generationConfig"]);e!==void 0&&s!=null&&r(e,["setup","generationConfig"],s);const l=i(n,["responseModalities"]);e!==void 0&&l!=null&&r(e,["setup","generationConfig","responseModalities"],l);const a=i(n,["temperature"]);e!==void 0&&a!=null&&r(e,["setup","generationConfig","temperature"],a);const u=i(n,["topP"]);e!==void 0&&u!=null&&r(e,["setup","generationConfig","topP"],u);const c=i(n,["topK"]);e!==void 0&&c!=null&&r(e,["setup","generationConfig","topK"],c);const d=i(n,["maxOutputTokens"]);e!==void 0&&d!=null&&r(e,["setup","generationConfig","maxOutputTokens"],d);const f=i(n,["mediaResolution"]);e!==void 0&&f!=null&&r(e,["setup","generationConfig","mediaResolution"],f);const p=i(n,["seed"]);e!==void 0&&p!=null&&r(e,["setup","generationConfig","seed"],p);const m=i(n,["speechConfig"]);e!==void 0&&m!=null&&r(e,["setup","generationConfig","speechConfig"],m);const g=i(n,["systemInstruction"]);e!==void 0&&g!=null&&r(e,["setup","systemInstruction"],Lo(o,P(o,g)));const h=i(n,["tools"]);if(e!==void 0&&h!=null){let E=ie(o,h);Array.isArray(E)&&(E=E.map(A=>Ko(o,oe(o,A)))),r(e,["setup","tools"],E)}const y=i(n,["sessionResumption"]);e!==void 0&&y!=null&&r(e,["setup","sessionResumption"],zo(o,y));const C=i(n,["inputAudioTranscription"]);e!==void 0&&C!=null&&r(e,["setup","inputAudioTranscription"],Sn());const v=i(n,["outputAudioTranscription"]);e!==void 0&&v!=null&&r(e,["setup","outputAudioTranscription"],Sn());const _=i(n,["realtimeInputConfig"]);e!==void 0&&_!=null&&r(e,["setup","realtimeInputConfig"],Zo(o,_));const S=i(n,["contextWindowCompression"]);return e!==void 0&&S!=null&&r(e,["setup","contextWindowCompression"],ni(o,S)),t}function ii(o,n){const e={},t=i(n,["model"]);t!=null&&r(e,["setup","model"],I(o,t));const s=i(n,["config"]);return s!=null&&r(e,["config"],ti(o,s,e)),e}function si(o,n){const e={},t=i(n,["model"]);t!=null&&r(e,["setup","model"],I(o,t));const s=i(n,["config"]);return s!=null&&r(e,["config"],oi(o,s,e)),e}function ri(){return{}}function li(){return{}}function ai(){return{}}function ui(){return{}}function di(o,n){const e={},t=i(n,["media"]);t!=null&&r(e,["mediaChunks"],Fn(o,t));const s=i(n,["audio"]);s!=null&&r(e,["audio"],at(o,s));const l=i(n,["audioStreamEnd"]);l!=null&&r(e,["audioStreamEnd"],l);const a=i(n,["video"]);a!=null&&r(e,["video"],lt(o,a));const u=i(n,["text"]);return u!=null&&r(e,["text"],u),i(n,["activityStart"])!=null&&r(e,["activityStart"],ri()),i(n,["activityEnd"])!=null&&r(e,["activityEnd"],ai()),e}function ci(o,n){const e={},t=i(n,["media"]);if(t!=null&&r(e,["mediaChunks"],Fn(o,t)),i(n,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const s=i(n,["audioStreamEnd"]);if(s!=null&&r(e,["audioStreamEnd"],s),i(n,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(i(n,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return i(n,["activityStart"])!=null&&r(e,["activityStart"],li()),i(n,["activityEnd"])!=null&&r(e,["activityEnd"],ui()),e}function fi(){return{}}function pi(){return{}}function mi(o,n){const e={},t=i(n,["data"]);t!=null&&r(e,["data"],t);const s=i(n,["mimeType"]);return s!=null&&r(e,["mimeType"],s),e}function gi(o,n){const e={},t=i(n,["displayName"]);t!=null&&r(e,["displayName"],t);const s=i(n,["data"]);s!=null&&r(e,["data"],s);const l=i(n,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function hi(o,n){const e={},t=i(n,["thought"]);t!=null&&r(e,["thought"],t);const s=i(n,["inlineData"]);s!=null&&r(e,["inlineData"],mi(o,s));const l=i(n,["codeExecutionResult"]);l!=null&&r(e,["codeExecutionResult"],l);const a=i(n,["executableCode"]);a!=null&&r(e,["executableCode"],a);const u=i(n,["fileData"]);u!=null&&r(e,["fileData"],u);const c=i(n,["functionCall"]);c!=null&&r(e,["functionCall"],c);const d=i(n,["functionResponse"]);d!=null&&r(e,["functionResponse"],d);const f=i(n,["text"]);return f!=null&&r(e,["text"],f),e}function yi(o,n){const e={},t=i(n,["videoMetadata"]);t!=null&&r(e,["videoMetadata"],t);const s=i(n,["thought"]);s!=null&&r(e,["thought"],s);const l=i(n,["inlineData"]);l!=null&&r(e,["inlineData"],gi(o,l));const a=i(n,["codeExecutionResult"]);a!=null&&r(e,["codeExecutionResult"],a);const u=i(n,["executableCode"]);u!=null&&r(e,["executableCode"],u);const c=i(n,["fileData"]);c!=null&&r(e,["fileData"],c);const d=i(n,["functionCall"]);d!=null&&r(e,["functionCall"],d);const f=i(n,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const p=i(n,["text"]);return p!=null&&r(e,["text"],p),e}function Ti(o,n){const e={},t=i(n,["parts"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(a=>hi(o,a))),r(e,["parts"],l)}const s=i(n,["role"]);return s!=null&&r(e,["role"],s),e}function Ci(o,n){const e={},t=i(n,["parts"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(a=>yi(o,a))),r(e,["parts"],l)}const s=i(n,["role"]);return s!=null&&r(e,["role"],s),e}function An(o,n){const e={},t=i(n,["text"]);t!=null&&r(e,["text"],t);const s=i(n,["finished"]);return s!=null&&r(e,["finished"],s),e}function Mn(o,n){const e={},t=i(n,["text"]);t!=null&&r(e,["text"],t);const s=i(n,["finished"]);return s!=null&&r(e,["finished"],s),e}function Ei(o,n){const e={},t=i(n,["modelTurn"]);t!=null&&r(e,["modelTurn"],Ti(o,t));const s=i(n,["turnComplete"]);s!=null&&r(e,["turnComplete"],s);const l=i(n,["interrupted"]);l!=null&&r(e,["interrupted"],l);const a=i(n,["groundingMetadata"]);a!=null&&r(e,["groundingMetadata"],a);const u=i(n,["generationComplete"]);u!=null&&r(e,["generationComplete"],u);const c=i(n,["inputTranscription"]);c!=null&&r(e,["inputTranscription"],An(o,c));const d=i(n,["outputTranscription"]);return d!=null&&r(e,["outputTranscription"],An(o,d)),e}function vi(o,n){const e={},t=i(n,["modelTurn"]);t!=null&&r(e,["modelTurn"],Ci(o,t));const s=i(n,["turnComplete"]);s!=null&&r(e,["turnComplete"],s);const l=i(n,["interrupted"]);l!=null&&r(e,["interrupted"],l);const a=i(n,["groundingMetadata"]);a!=null&&r(e,["groundingMetadata"],a);const u=i(n,["generationComplete"]);u!=null&&r(e,["generationComplete"],u);const c=i(n,["inputTranscription"]);c!=null&&r(e,["inputTranscription"],Mn(o,c));const d=i(n,["outputTranscription"]);return d!=null&&r(e,["outputTranscription"],Mn(o,d)),e}function _i(o,n){const e={},t=i(n,["id"]);t!=null&&r(e,["id"],t);const s=i(n,["args"]);s!=null&&r(e,["args"],s);const l=i(n,["name"]);return l!=null&&r(e,["name"],l),e}function Ii(o,n){const e={},t=i(n,["args"]);t!=null&&r(e,["args"],t);const s=i(n,["name"]);return s!=null&&r(e,["name"],s),e}function Si(o,n){const e={},t=i(n,["functionCalls"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(l=>_i(o,l))),r(e,["functionCalls"],s)}return e}function Ai(o,n){const e={},t=i(n,["functionCalls"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(l=>Ii(o,l))),r(e,["functionCalls"],s)}return e}function Mi(o,n){const e={},t=i(n,["ids"]);return t!=null&&r(e,["ids"],t),e}function Pi(o,n){const e={},t=i(n,["ids"]);return t!=null&&r(e,["ids"],t),e}function z(o,n){const e={},t=i(n,["modality"]);t!=null&&r(e,["modality"],t);const s=i(n,["tokenCount"]);return s!=null&&r(e,["tokenCount"],s),e}function b(o,n){const e={},t=i(n,["modality"]);t!=null&&r(e,["modality"],t);const s=i(n,["tokenCount"]);return s!=null&&r(e,["tokenCount"],s),e}function Ri(o,n){const e={},t=i(n,["promptTokenCount"]);t!=null&&r(e,["promptTokenCount"],t);const s=i(n,["cachedContentTokenCount"]);s!=null&&r(e,["cachedContentTokenCount"],s);const l=i(n,["responseTokenCount"]);l!=null&&r(e,["responseTokenCount"],l);const a=i(n,["toolUsePromptTokenCount"]);a!=null&&r(e,["toolUsePromptTokenCount"],a);const u=i(n,["thoughtsTokenCount"]);u!=null&&r(e,["thoughtsTokenCount"],u);const c=i(n,["totalTokenCount"]);c!=null&&r(e,["totalTokenCount"],c);const d=i(n,["promptTokensDetails"]);if(d!=null){let g=d;Array.isArray(g)&&(g=g.map(h=>z(o,h))),r(e,["promptTokensDetails"],g)}const f=i(n,["cacheTokensDetails"]);if(f!=null){let g=f;Array.isArray(g)&&(g=g.map(h=>z(o,h))),r(e,["cacheTokensDetails"],g)}const p=i(n,["responseTokensDetails"]);if(p!=null){let g=p;Array.isArray(g)&&(g=g.map(h=>z(o,h))),r(e,["responseTokensDetails"],g)}const m=i(n,["toolUsePromptTokensDetails"]);if(m!=null){let g=m;Array.isArray(g)&&(g=g.map(h=>z(o,h))),r(e,["toolUsePromptTokensDetails"],g)}return e}function Di(o,n){const e={},t=i(n,["promptTokenCount"]);t!=null&&r(e,["promptTokenCount"],t);const s=i(n,["cachedContentTokenCount"]);s!=null&&r(e,["cachedContentTokenCount"],s);const l=i(n,["candidatesTokenCount"]);l!=null&&r(e,["responseTokenCount"],l);const a=i(n,["toolUsePromptTokenCount"]);a!=null&&r(e,["toolUsePromptTokenCount"],a);const u=i(n,["thoughtsTokenCount"]);u!=null&&r(e,["thoughtsTokenCount"],u);const c=i(n,["totalTokenCount"]);c!=null&&r(e,["totalTokenCount"],c);const d=i(n,["promptTokensDetails"]);if(d!=null){let h=d;Array.isArray(h)&&(h=h.map(y=>b(o,y))),r(e,["promptTokensDetails"],h)}const f=i(n,["cacheTokensDetails"]);if(f!=null){let h=f;Array.isArray(h)&&(h=h.map(y=>b(o,y))),r(e,["cacheTokensDetails"],h)}const p=i(n,["candidatesTokensDetails"]);if(p!=null){let h=p;Array.isArray(h)&&(h=h.map(y=>b(o,y))),r(e,["responseTokensDetails"],h)}const m=i(n,["toolUsePromptTokensDetails"]);if(m!=null){let h=m;Array.isArray(h)&&(h=h.map(y=>b(o,y))),r(e,["toolUsePromptTokensDetails"],h)}const g=i(n,["trafficType"]);return g!=null&&r(e,["trafficType"],g),e}function xi(o,n){const e={},t=i(n,["timeLeft"]);return t!=null&&r(e,["timeLeft"],t),e}function Ni(o,n){const e={},t=i(n,["timeLeft"]);return t!=null&&r(e,["timeLeft"],t),e}function wi(o,n){const e={},t=i(n,["newHandle"]);t!=null&&r(e,["newHandle"],t);const s=i(n,["resumable"]);s!=null&&r(e,["resumable"],s);const l=i(n,["lastConsumedClientMessageIndex"]);return l!=null&&r(e,["lastConsumedClientMessageIndex"],l),e}function Li(o,n){const e={},t=i(n,["newHandle"]);t!=null&&r(e,["newHandle"],t);const s=i(n,["resumable"]);s!=null&&r(e,["resumable"],s);const l=i(n,["lastConsumedClientMessageIndex"]);return l!=null&&r(e,["lastConsumedClientMessageIndex"],l),e}function Vi(o,n){const e={};i(n,["setupComplete"])!=null&&r(e,["setupComplete"],fi());const s=i(n,["serverContent"]);s!=null&&r(e,["serverContent"],Ei(o,s));const l=i(n,["toolCall"]);l!=null&&r(e,["toolCall"],Si(o,l));const a=i(n,["toolCallCancellation"]);a!=null&&r(e,["toolCallCancellation"],Mi(o,a));const u=i(n,["usageMetadata"]);u!=null&&r(e,["usageMetadata"],Ri(o,u));const c=i(n,["goAway"]);c!=null&&r(e,["goAway"],xi(o,c));const d=i(n,["sessionResumptionUpdate"]);return d!=null&&r(e,["sessionResumptionUpdate"],wi(o,d)),e}function Ui(o,n){const e={};i(n,["setupComplete"])!=null&&r(e,["setupComplete"],pi());const s=i(n,["serverContent"]);s!=null&&r(e,["serverContent"],vi(o,s));const l=i(n,["toolCall"]);l!=null&&r(e,["toolCall"],Ai(o,l));const a=i(n,["toolCallCancellation"]);a!=null&&r(e,["toolCallCancellation"],Pi(o,a));const u=i(n,["usageMetadata"]);u!=null&&r(e,["usageMetadata"],Di(o,u));const c=i(n,["goAway"]);c!=null&&r(e,["goAway"],Ni(o,c));const d=i(n,["sessionResumptionUpdate"]);return d!=null&&r(e,["sessionResumptionUpdate"],Li(o,d)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Fi(o,n){const e={};if(i(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=i(n,["data"]);t!=null&&r(e,["data"],t);const s=i(n,["mimeType"]);return s!=null&&r(e,["mimeType"],s),e}function ki(o,n){const e={};if(i(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const t=i(n,["thought"]);t!=null&&r(e,["thought"],t);const s=i(n,["inlineData"]);s!=null&&r(e,["inlineData"],Fi(o,s));const l=i(n,["codeExecutionResult"]);l!=null&&r(e,["codeExecutionResult"],l);const a=i(n,["executableCode"]);a!=null&&r(e,["executableCode"],a);const u=i(n,["fileData"]);u!=null&&r(e,["fileData"],u);const c=i(n,["functionCall"]);c!=null&&r(e,["functionCall"],c);const d=i(n,["functionResponse"]);d!=null&&r(e,["functionResponse"],d);const f=i(n,["text"]);return f!=null&&r(e,["text"],f),e}function re(o,n){const e={},t=i(n,["parts"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(a=>ki(o,a))),r(e,["parts"],l)}const s=i(n,["role"]);return s!=null&&r(e,["role"],s),e}function qi(o,n){const e={};if(i(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=i(n,["category"]);t!=null&&r(e,["category"],t);const s=i(n,["threshold"]);return s!=null&&r(e,["threshold"],s),e}function Gi(){return{}}function Bi(o,n){const e={},t=i(n,["mode"]);t!=null&&r(e,["mode"],t);const s=i(n,["dynamicThreshold"]);return s!=null&&r(e,["dynamicThreshold"],s),e}function Hi(o,n){const e={},t=i(n,["dynamicRetrievalConfig"]);return t!=null&&r(e,["dynamicRetrievalConfig"],Bi(o,t)),e}function Ji(o,n){const e={};if(i(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");i(n,["googleSearch"])!=null&&r(e,["googleSearch"],Gi());const s=i(n,["googleSearchRetrieval"]);if(s!=null&&r(e,["googleSearchRetrieval"],Hi(o,s)),i(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(i(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=i(n,["codeExecution"]);l!=null&&r(e,["codeExecution"],l);const a=i(n,["functionDeclarations"]);return a!=null&&r(e,["functionDeclarations"],a),e}function $i(o,n){const e={},t=i(n,["mode"]);t!=null&&r(e,["mode"],t);const s=i(n,["allowedFunctionNames"]);return s!=null&&r(e,["allowedFunctionNames"],s),e}function Yi(o,n){const e={},t=i(n,["functionCallingConfig"]);if(t!=null&&r(e,["functionCallingConfig"],$i(o,t)),i(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return e}function Ki(o,n){const e={},t=i(n,["voiceName"]);return t!=null&&r(e,["voiceName"],t),e}function Wi(o,n){const e={},t=i(n,["prebuiltVoiceConfig"]);return t!=null&&r(e,["prebuiltVoiceConfig"],Ki(o,t)),e}function zi(o,n){const e={},t=i(n,["voiceConfig"]);t!=null&&r(e,["voiceConfig"],Wi(o,t));const s=i(n,["languageCode"]);return s!=null&&r(e,["languageCode"],s),e}function bi(o,n){const e={},t=i(n,["includeThoughts"]);t!=null&&r(e,["includeThoughts"],t);const s=i(n,["thinkingBudget"]);return s!=null&&r(e,["thinkingBudget"],s),e}function Oi(o,n,e){const t={},s=i(n,["systemInstruction"]);e!==void 0&&s!=null&&r(e,["systemInstruction"],re(o,P(o,s)));const l=i(n,["temperature"]);l!=null&&r(t,["temperature"],l);const a=i(n,["topP"]);a!=null&&r(t,["topP"],a);const u=i(n,["topK"]);u!=null&&r(t,["topK"],u);const c=i(n,["candidateCount"]);c!=null&&r(t,["candidateCount"],c);const d=i(n,["maxOutputTokens"]);d!=null&&r(t,["maxOutputTokens"],d);const f=i(n,["stopSequences"]);f!=null&&r(t,["stopSequences"],f);const p=i(n,["responseLogprobs"]);p!=null&&r(t,["responseLogprobs"],p);const m=i(n,["logprobs"]);m!=null&&r(t,["logprobs"],m);const g=i(n,["presencePenalty"]);g!=null&&r(t,["presencePenalty"],g);const h=i(n,["frequencyPenalty"]);h!=null&&r(t,["frequencyPenalty"],h);const y=i(n,["seed"]);y!=null&&r(t,["seed"],y);const C=i(n,["responseMimeType"]);C!=null&&r(t,["responseMimeType"],C);const v=i(n,["responseSchema"]);if(v!=null&&r(t,["responseSchema"],Gn(o,v)),i(n,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(i(n,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const _=i(n,["safetySettings"]);if(e!==void 0&&_!=null){let R=_;Array.isArray(R)&&(R=R.map(V=>qi(o,V))),r(e,["safetySettings"],R)}const S=i(n,["tools"]);if(e!==void 0&&S!=null){let R=ie(o,S);Array.isArray(R)&&(R=R.map(V=>Ji(o,oe(o,V)))),r(e,["tools"],R)}const E=i(n,["toolConfig"]);if(e!==void 0&&E!=null&&r(e,["toolConfig"],Yi(o,E)),i(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const A=i(n,["cachedContent"]);e!==void 0&&A!=null&&r(e,["cachedContent"],w(o,A));const G=i(n,["responseModalities"]);G!=null&&r(t,["responseModalities"],G);const B=i(n,["mediaResolution"]);B!=null&&r(t,["mediaResolution"],B);const H=i(n,["speechConfig"]);if(H!=null&&r(t,["speechConfig"],zi(o,Bn(o,H))),i(n,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const J=i(n,["thinkingConfig"]);return J!=null&&r(t,["thinkingConfig"],bi(o,J)),t}function Pn(o,n){const e={},t=i(n,["model"]);t!=null&&r(e,["_url","model"],I(o,t));const s=i(n,["contents"]);if(s!=null){let a=N(o,s);Array.isArray(a)&&(a=a.map(u=>re(o,u))),r(e,["contents"],a)}const l=i(n,["config"]);return l!=null&&r(e,["generationConfig"],Oi(o,l,e)),e}function Xi(o,n,e){const t={},s=i(n,["taskType"]);e!==void 0&&s!=null&&r(e,["requests[]","taskType"],s);const l=i(n,["title"]);e!==void 0&&l!=null&&r(e,["requests[]","title"],l);const a=i(n,["outputDimensionality"]);if(e!==void 0&&a!=null&&r(e,["requests[]","outputDimensionality"],a),i(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(i(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function Zi(o,n){const e={},t=i(n,["model"]);t!=null&&r(e,["_url","model"],I(o,t));const s=i(n,["contents"]);s!=null&&r(e,["requests[]","content"],qn(o,s));const l=i(n,["config"]);l!=null&&r(e,["config"],Xi(o,l,e));const a=i(n,["model"]);return a!==void 0&&r(e,["requests[]","model"],I(o,a)),e}function Qi(o,n,e){const t={};if(i(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(i(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const s=i(n,["numberOfImages"]);e!==void 0&&s!=null&&r(e,["parameters","sampleCount"],s);const l=i(n,["aspectRatio"]);e!==void 0&&l!=null&&r(e,["parameters","aspectRatio"],l);const a=i(n,["guidanceScale"]);if(e!==void 0&&a!=null&&r(e,["parameters","guidanceScale"],a),i(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=i(n,["safetyFilterLevel"]);e!==void 0&&u!=null&&r(e,["parameters","safetySetting"],u);const c=i(n,["personGeneration"]);e!==void 0&&c!=null&&r(e,["parameters","personGeneration"],c);const d=i(n,["includeSafetyAttributes"]);e!==void 0&&d!=null&&r(e,["parameters","includeSafetyAttributes"],d);const f=i(n,["includeRaiReason"]);e!==void 0&&f!=null&&r(e,["parameters","includeRaiReason"],f);const p=i(n,["language"]);e!==void 0&&p!=null&&r(e,["parameters","language"],p);const m=i(n,["outputMimeType"]);e!==void 0&&m!=null&&r(e,["parameters","outputOptions","mimeType"],m);const g=i(n,["outputCompressionQuality"]);if(e!==void 0&&g!=null&&r(e,["parameters","outputOptions","compressionQuality"],g),i(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(i(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function ji(o,n){const e={},t=i(n,["model"]);t!=null&&r(e,["_url","model"],I(o,t));const s=i(n,["prompt"]);s!=null&&r(e,["instances[0]","prompt"],s);const l=i(n,["config"]);return l!=null&&r(e,["config"],Qi(o,l,e)),e}function es(o,n){const e={},t=i(n,["model"]);t!=null&&r(e,["_url","name"],I(o,t));const s=i(n,["config"]);return s!=null&&r(e,["config"],s),e}function ns(o,n,e){const t={},s=i(n,["pageSize"]);e!==void 0&&s!=null&&r(e,["_query","pageSize"],s);const l=i(n,["pageToken"]);e!==void 0&&l!=null&&r(e,["_query","pageToken"],l);const a=i(n,["filter"]);e!==void 0&&a!=null&&r(e,["_query","filter"],a);const u=i(n,["queryBase"]);return e!==void 0&&u!=null&&r(e,["_url","models_url"],$n(o,u)),t}function ts(o,n){const e={},t=i(n,["config"]);return t!=null&&r(e,["config"],ns(o,t,e)),e}function os(o,n,e){const t={},s=i(n,["displayName"]);e!==void 0&&s!=null&&r(e,["displayName"],s);const l=i(n,["description"]);e!==void 0&&l!=null&&r(e,["description"],l);const a=i(n,["defaultCheckpointId"]);return e!==void 0&&a!=null&&r(e,["defaultCheckpointId"],a),t}function is(o,n){const e={},t=i(n,["model"]);t!=null&&r(e,["_url","name"],I(o,t));const s=i(n,["config"]);return s!=null&&r(e,["config"],os(o,s,e)),e}function ss(o,n){const e={},t=i(n,["model"]);t!=null&&r(e,["_url","name"],I(o,t));const s=i(n,["config"]);return s!=null&&r(e,["config"],s),e}function rs(o,n){const e={};if(i(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(i(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(i(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function ls(o,n){const e={},t=i(n,["model"]);t!=null&&r(e,["_url","model"],I(o,t));const s=i(n,["contents"]);if(s!=null){let a=N(o,s);Array.isArray(a)&&(a=a.map(u=>re(o,u))),r(e,["contents"],a)}const l=i(n,["config"]);return l!=null&&r(e,["config"],rs(o,l)),e}function as(o,n){const e={};if(i(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=i(n,["imageBytes"]);t!=null&&r(e,["bytesBase64Encoded"],L(o,t));const s=i(n,["mimeType"]);return s!=null&&r(e,["mimeType"],s),e}function us(o,n,e){const t={},s=i(n,["numberOfVideos"]);if(e!==void 0&&s!=null&&r(e,["parameters","sampleCount"],s),i(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(i(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const l=i(n,["durationSeconds"]);if(e!==void 0&&l!=null&&r(e,["parameters","durationSeconds"],l),i(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=i(n,["aspectRatio"]);if(e!==void 0&&a!=null&&r(e,["parameters","aspectRatio"],a),i(n,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const u=i(n,["personGeneration"]);if(e!==void 0&&u!=null&&r(e,["parameters","personGeneration"],u),i(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=i(n,["negativePrompt"]);if(e!==void 0&&c!=null&&r(e,["parameters","negativePrompt"],c),i(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function ds(o,n){const e={},t=i(n,["model"]);t!=null&&r(e,["_url","model"],I(o,t));const s=i(n,["prompt"]);s!=null&&r(e,["instances[0]","prompt"],s);const l=i(n,["image"]);l!=null&&r(e,["instances[0]","image"],as(o,l));const a=i(n,["config"]);return a!=null&&r(e,["config"],us(o,a,e)),e}function cs(o,n){const e={},t=i(n,["displayName"]);t!=null&&r(e,["displayName"],t);const s=i(n,["data"]);s!=null&&r(e,["data"],s);const l=i(n,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function fs(o,n){const e={},t=i(n,["videoMetadata"]);t!=null&&r(e,["videoMetadata"],t);const s=i(n,["thought"]);s!=null&&r(e,["thought"],s);const l=i(n,["inlineData"]);l!=null&&r(e,["inlineData"],cs(o,l));const a=i(n,["codeExecutionResult"]);a!=null&&r(e,["codeExecutionResult"],a);const u=i(n,["executableCode"]);u!=null&&r(e,["executableCode"],u);const c=i(n,["fileData"]);c!=null&&r(e,["fileData"],c);const d=i(n,["functionCall"]);d!=null&&r(e,["functionCall"],d);const f=i(n,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const p=i(n,["text"]);return p!=null&&r(e,["text"],p),e}function q(o,n){const e={},t=i(n,["parts"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(a=>fs(o,a))),r(e,["parts"],l)}const s=i(n,["role"]);return s!=null&&r(e,["role"],s),e}function ps(o,n){const e={},t=i(n,["featureSelectionPreference"]);return t!=null&&r(e,["featureSelectionPreference"],t),e}function ms(o,n){const e={},t=i(n,["method"]);t!=null&&r(e,["method"],t);const s=i(n,["category"]);s!=null&&r(e,["category"],s);const l=i(n,["threshold"]);return l!=null&&r(e,["threshold"],l),e}function gs(){return{}}function hs(o,n){const e={},t=i(n,["mode"]);t!=null&&r(e,["mode"],t);const s=i(n,["dynamicThreshold"]);return s!=null&&r(e,["dynamicThreshold"],s),e}function ys(o,n){const e={},t=i(n,["dynamicRetrievalConfig"]);return t!=null&&r(e,["dynamicRetrievalConfig"],hs(o,t)),e}function Ts(){return{}}function Cs(o,n){const e={},t=i(n,["apiKeyString"]);return t!=null&&r(e,["apiKeyString"],t),e}function Es(o,n){const e={},t=i(n,["apiKeyConfig"]);t!=null&&r(e,["apiKeyConfig"],Cs(o,t));const s=i(n,["authType"]);s!=null&&r(e,["authType"],s);const l=i(n,["googleServiceAccountConfig"]);l!=null&&r(e,["googleServiceAccountConfig"],l);const a=i(n,["httpBasicAuthConfig"]);a!=null&&r(e,["httpBasicAuthConfig"],a);const u=i(n,["oauthConfig"]);u!=null&&r(e,["oauthConfig"],u);const c=i(n,["oidcConfig"]);return c!=null&&r(e,["oidcConfig"],c),e}function vs(o,n){const e={},t=i(n,["authConfig"]);return t!=null&&r(e,["authConfig"],Es(o,t)),e}function Wn(o,n){const e={},t=i(n,["retrieval"]);t!=null&&r(e,["retrieval"],t),i(n,["googleSearch"])!=null&&r(e,["googleSearch"],gs());const l=i(n,["googleSearchRetrieval"]);l!=null&&r(e,["googleSearchRetrieval"],ys(o,l)),i(n,["enterpriseWebSearch"])!=null&&r(e,["enterpriseWebSearch"],Ts());const u=i(n,["googleMaps"]);u!=null&&r(e,["googleMaps"],vs(o,u));const c=i(n,["codeExecution"]);c!=null&&r(e,["codeExecution"],c);const d=i(n,["functionDeclarations"]);return d!=null&&r(e,["functionDeclarations"],d),e}function _s(o,n){const e={},t=i(n,["mode"]);t!=null&&r(e,["mode"],t);const s=i(n,["allowedFunctionNames"]);return s!=null&&r(e,["allowedFunctionNames"],s),e}function Is(o,n){const e={},t=i(n,["latitude"]);t!=null&&r(e,["latitude"],t);const s=i(n,["longitude"]);return s!=null&&r(e,["longitude"],s),e}function Ss(o,n){const e={},t=i(n,["latLng"]);return t!=null&&r(e,["latLng"],Is(o,t)),e}function As(o,n){const e={},t=i(n,["functionCallingConfig"]);t!=null&&r(e,["functionCallingConfig"],_s(o,t));const s=i(n,["retrievalConfig"]);return s!=null&&r(e,["retrievalConfig"],Ss(o,s)),e}function Ms(o,n){const e={},t=i(n,["voiceName"]);return t!=null&&r(e,["voiceName"],t),e}function Ps(o,n){const e={},t=i(n,["prebuiltVoiceConfig"]);return t!=null&&r(e,["prebuiltVoiceConfig"],Ms(o,t)),e}function Rs(o,n){const e={},t=i(n,["voiceConfig"]);t!=null&&r(e,["voiceConfig"],Ps(o,t));const s=i(n,["languageCode"]);return s!=null&&r(e,["languageCode"],s),e}function Ds(o,n){const e={},t=i(n,["includeThoughts"]);t!=null&&r(e,["includeThoughts"],t);const s=i(n,["thinkingBudget"]);return s!=null&&r(e,["thinkingBudget"],s),e}function xs(o,n,e){const t={},s=i(n,["systemInstruction"]);e!==void 0&&s!=null&&r(e,["systemInstruction"],q(o,P(o,s)));const l=i(n,["temperature"]);l!=null&&r(t,["temperature"],l);const a=i(n,["topP"]);a!=null&&r(t,["topP"],a);const u=i(n,["topK"]);u!=null&&r(t,["topK"],u);const c=i(n,["candidateCount"]);c!=null&&r(t,["candidateCount"],c);const d=i(n,["maxOutputTokens"]);d!=null&&r(t,["maxOutputTokens"],d);const f=i(n,["stopSequences"]);f!=null&&r(t,["stopSequences"],f);const p=i(n,["responseLogprobs"]);p!=null&&r(t,["responseLogprobs"],p);const m=i(n,["logprobs"]);m!=null&&r(t,["logprobs"],m);const g=i(n,["presencePenalty"]);g!=null&&r(t,["presencePenalty"],g);const h=i(n,["frequencyPenalty"]);h!=null&&r(t,["frequencyPenalty"],h);const y=i(n,["seed"]);y!=null&&r(t,["seed"],y);const C=i(n,["responseMimeType"]);C!=null&&r(t,["responseMimeType"],C);const v=i(n,["responseSchema"]);v!=null&&r(t,["responseSchema"],Gn(o,v));const _=i(n,["routingConfig"]);_!=null&&r(t,["routingConfig"],_);const S=i(n,["modelSelectionConfig"]);S!=null&&r(t,["modelConfig"],ps(o,S));const E=i(n,["safetySettings"]);if(e!==void 0&&E!=null){let D=E;Array.isArray(D)&&(D=D.map(ae=>ms(o,ae))),r(e,["safetySettings"],D)}const A=i(n,["tools"]);if(e!==void 0&&A!=null){let D=ie(o,A);Array.isArray(D)&&(D=D.map(ae=>Wn(o,oe(o,ae)))),r(e,["tools"],D)}const G=i(n,["toolConfig"]);e!==void 0&&G!=null&&r(e,["toolConfig"],As(o,G));const B=i(n,["labels"]);e!==void 0&&B!=null&&r(e,["labels"],B);const H=i(n,["cachedContent"]);e!==void 0&&H!=null&&r(e,["cachedContent"],w(o,H));const J=i(n,["responseModalities"]);J!=null&&r(t,["responseModalities"],J);const R=i(n,["mediaResolution"]);R!=null&&r(t,["mediaResolution"],R);const V=i(n,["speechConfig"]);V!=null&&r(t,["speechConfig"],Rs(o,Bn(o,V)));const Re=i(n,["audioTimestamp"]);Re!=null&&r(t,["audioTimestamp"],Re);const De=i(n,["thinkingConfig"]);return De!=null&&r(t,["thinkingConfig"],Ds(o,De)),t}function Rn(o,n){const e={},t=i(n,["model"]);t!=null&&r(e,["_url","model"],I(o,t));const s=i(n,["contents"]);if(s!=null){let a=N(o,s);Array.isArray(a)&&(a=a.map(u=>q(o,u))),r(e,["contents"],a)}const l=i(n,["config"]);return l!=null&&r(e,["generationConfig"],xs(o,l,e)),e}function Ns(o,n,e){const t={},s=i(n,["taskType"]);e!==void 0&&s!=null&&r(e,["instances[]","task_type"],s);const l=i(n,["title"]);e!==void 0&&l!=null&&r(e,["instances[]","title"],l);const a=i(n,["outputDimensionality"]);e!==void 0&&a!=null&&r(e,["parameters","outputDimensionality"],a);const u=i(n,["mimeType"]);e!==void 0&&u!=null&&r(e,["instances[]","mimeType"],u);const c=i(n,["autoTruncate"]);return e!==void 0&&c!=null&&r(e,["parameters","autoTruncate"],c),t}function ws(o,n){const e={},t=i(n,["model"]);t!=null&&r(e,["_url","model"],I(o,t));const s=i(n,["contents"]);s!=null&&r(e,["instances[]","content"],qn(o,s));const l=i(n,["config"]);return l!=null&&r(e,["config"],Ns(o,l,e)),e}function Ls(o,n,e){const t={},s=i(n,["outputGcsUri"]);e!==void 0&&s!=null&&r(e,["parameters","storageUri"],s);const l=i(n,["negativePrompt"]);e!==void 0&&l!=null&&r(e,["parameters","negativePrompt"],l);const a=i(n,["numberOfImages"]);e!==void 0&&a!=null&&r(e,["parameters","sampleCount"],a);const u=i(n,["aspectRatio"]);e!==void 0&&u!=null&&r(e,["parameters","aspectRatio"],u);const c=i(n,["guidanceScale"]);e!==void 0&&c!=null&&r(e,["parameters","guidanceScale"],c);const d=i(n,["seed"]);e!==void 0&&d!=null&&r(e,["parameters","seed"],d);const f=i(n,["safetyFilterLevel"]);e!==void 0&&f!=null&&r(e,["parameters","safetySetting"],f);const p=i(n,["personGeneration"]);e!==void 0&&p!=null&&r(e,["parameters","personGeneration"],p);const m=i(n,["includeSafetyAttributes"]);e!==void 0&&m!=null&&r(e,["parameters","includeSafetyAttributes"],m);const g=i(n,["includeRaiReason"]);e!==void 0&&g!=null&&r(e,["parameters","includeRaiReason"],g);const h=i(n,["language"]);e!==void 0&&h!=null&&r(e,["parameters","language"],h);const y=i(n,["outputMimeType"]);e!==void 0&&y!=null&&r(e,["parameters","outputOptions","mimeType"],y);const C=i(n,["outputCompressionQuality"]);e!==void 0&&C!=null&&r(e,["parameters","outputOptions","compressionQuality"],C);const v=i(n,["addWatermark"]);e!==void 0&&v!=null&&r(e,["parameters","addWatermark"],v);const _=i(n,["enhancePrompt"]);return e!==void 0&&_!=null&&r(e,["parameters","enhancePrompt"],_),t}function Vs(o,n){const e={},t=i(n,["model"]);t!=null&&r(e,["_url","model"],I(o,t));const s=i(n,["prompt"]);s!=null&&r(e,["instances[0]","prompt"],s);const l=i(n,["config"]);return l!=null&&r(e,["config"],Ls(o,l,e)),e}function Me(o,n){const e={},t=i(n,["gcsUri"]);t!=null&&r(e,["gcsUri"],t);const s=i(n,["imageBytes"]);s!=null&&r(e,["bytesBase64Encoded"],L(o,s));const l=i(n,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function Us(o,n){const e={},t=i(n,["maskMode"]);t!=null&&r(e,["maskMode"],t);const s=i(n,["segmentationClasses"]);s!=null&&r(e,["maskClasses"],s);const l=i(n,["maskDilation"]);return l!=null&&r(e,["dilation"],l),e}function Fs(o,n){const e={},t=i(n,["controlType"]);t!=null&&r(e,["controlType"],t);const s=i(n,["enableControlImageComputation"]);return s!=null&&r(e,["computeControl"],s),e}function ks(o,n){const e={},t=i(n,["styleDescription"]);return t!=null&&r(e,["styleDescription"],t),e}function qs(o,n){const e={},t=i(n,["subjectType"]);t!=null&&r(e,["subjectType"],t);const s=i(n,["subjectDescription"]);return s!=null&&r(e,["subjectDescription"],s),e}function Gs(o,n){const e={},t=i(n,["referenceImage"]);t!=null&&r(e,["referenceImage"],Me(o,t));const s=i(n,["referenceId"]);s!=null&&r(e,["referenceId"],s);const l=i(n,["referenceType"]);l!=null&&r(e,["referenceType"],l);const a=i(n,["maskImageConfig"]);a!=null&&r(e,["maskImageConfig"],Us(o,a));const u=i(n,["controlImageConfig"]);u!=null&&r(e,["controlImageConfig"],Fs(o,u));const c=i(n,["styleImageConfig"]);c!=null&&r(e,["styleImageConfig"],ks(o,c));const d=i(n,["subjectImageConfig"]);return d!=null&&r(e,["subjectImageConfig"],qs(o,d)),e}function Bs(o,n,e){const t={},s=i(n,["outputGcsUri"]);e!==void 0&&s!=null&&r(e,["parameters","storageUri"],s);const l=i(n,["negativePrompt"]);e!==void 0&&l!=null&&r(e,["parameters","negativePrompt"],l);const a=i(n,["numberOfImages"]);e!==void 0&&a!=null&&r(e,["parameters","sampleCount"],a);const u=i(n,["aspectRatio"]);e!==void 0&&u!=null&&r(e,["parameters","aspectRatio"],u);const c=i(n,["guidanceScale"]);e!==void 0&&c!=null&&r(e,["parameters","guidanceScale"],c);const d=i(n,["seed"]);e!==void 0&&d!=null&&r(e,["parameters","seed"],d);const f=i(n,["safetyFilterLevel"]);e!==void 0&&f!=null&&r(e,["parameters","safetySetting"],f);const p=i(n,["personGeneration"]);e!==void 0&&p!=null&&r(e,["parameters","personGeneration"],p);const m=i(n,["includeSafetyAttributes"]);e!==void 0&&m!=null&&r(e,["parameters","includeSafetyAttributes"],m);const g=i(n,["includeRaiReason"]);e!==void 0&&g!=null&&r(e,["parameters","includeRaiReason"],g);const h=i(n,["language"]);e!==void 0&&h!=null&&r(e,["parameters","language"],h);const y=i(n,["outputMimeType"]);e!==void 0&&y!=null&&r(e,["parameters","outputOptions","mimeType"],y);const C=i(n,["outputCompressionQuality"]);e!==void 0&&C!=null&&r(e,["parameters","outputOptions","compressionQuality"],C);const v=i(n,["editMode"]);e!==void 0&&v!=null&&r(e,["parameters","editMode"],v);const _=i(n,["baseSteps"]);return e!==void 0&&_!=null&&r(e,["parameters","editConfig","baseSteps"],_),t}function Hs(o,n){const e={},t=i(n,["model"]);t!=null&&r(e,["_url","model"],I(o,t));const s=i(n,["prompt"]);s!=null&&r(e,["instances[0]","prompt"],s);const l=i(n,["referenceImages"]);if(l!=null){let u=l;Array.isArray(u)&&(u=u.map(c=>Gs(o,c))),r(e,["instances[0]","referenceImages"],u)}const a=i(n,["config"]);return a!=null&&r(e,["config"],Bs(o,a,e)),e}function Js(o,n,e){const t={},s=i(n,["includeRaiReason"]);e!==void 0&&s!=null&&r(e,["parameters","includeRaiReason"],s);const l=i(n,["outputMimeType"]);e!==void 0&&l!=null&&r(e,["parameters","outputOptions","mimeType"],l);const a=i(n,["outputCompressionQuality"]);e!==void 0&&a!=null&&r(e,["parameters","outputOptions","compressionQuality"],a);const u=i(n,["numberOfImages"]);e!==void 0&&u!=null&&r(e,["parameters","sampleCount"],u);const c=i(n,["mode"]);return e!==void 0&&c!=null&&r(e,["parameters","mode"],c),t}function $s(o,n){const e={},t=i(n,["model"]);t!=null&&r(e,["_url","model"],I(o,t));const s=i(n,["image"]);s!=null&&r(e,["instances[0]","image"],Me(o,s));const l=i(n,["upscaleFactor"]);l!=null&&r(e,["parameters","upscaleConfig","upscaleFactor"],l);const a=i(n,["config"]);return a!=null&&r(e,["config"],Js(o,a,e)),e}function Ys(o,n){const e={},t=i(n,["model"]);t!=null&&r(e,["_url","name"],I(o,t));const s=i(n,["config"]);return s!=null&&r(e,["config"],s),e}function Ks(o,n,e){const t={},s=i(n,["pageSize"]);e!==void 0&&s!=null&&r(e,["_query","pageSize"],s);const l=i(n,["pageToken"]);e!==void 0&&l!=null&&r(e,["_query","pageToken"],l);const a=i(n,["filter"]);e!==void 0&&a!=null&&r(e,["_query","filter"],a);const u=i(n,["queryBase"]);return e!==void 0&&u!=null&&r(e,["_url","models_url"],$n(o,u)),t}function Ws(o,n){const e={},t=i(n,["config"]);return t!=null&&r(e,["config"],Ks(o,t,e)),e}function zs(o,n,e){const t={},s=i(n,["displayName"]);e!==void 0&&s!=null&&r(e,["displayName"],s);const l=i(n,["description"]);e!==void 0&&l!=null&&r(e,["description"],l);const a=i(n,["defaultCheckpointId"]);return e!==void 0&&a!=null&&r(e,["defaultCheckpointId"],a),t}function bs(o,n){const e={},t=i(n,["model"]);t!=null&&r(e,["_url","model"],I(o,t));const s=i(n,["config"]);return s!=null&&r(e,["config"],zs(o,s,e)),e}function Os(o,n){const e={},t=i(n,["model"]);t!=null&&r(e,["_url","name"],I(o,t));const s=i(n,["config"]);return s!=null&&r(e,["config"],s),e}function Xs(o,n,e){const t={},s=i(n,["systemInstruction"]);e!==void 0&&s!=null&&r(e,["systemInstruction"],q(o,P(o,s)));const l=i(n,["tools"]);if(e!==void 0&&l!=null){let u=l;Array.isArray(u)&&(u=u.map(c=>Wn(o,c))),r(e,["tools"],u)}const a=i(n,["generationConfig"]);return e!==void 0&&a!=null&&r(e,["generationConfig"],a),t}function Zs(o,n){const e={},t=i(n,["model"]);t!=null&&r(e,["_url","model"],I(o,t));const s=i(n,["contents"]);if(s!=null){let a=N(o,s);Array.isArray(a)&&(a=a.map(u=>q(o,u))),r(e,["contents"],a)}const l=i(n,["config"]);return l!=null&&r(e,["config"],Xs(o,l,e)),e}function Qs(o,n){const e={},t=i(n,["model"]);t!=null&&r(e,["_url","model"],I(o,t));const s=i(n,["contents"]);if(s!=null){let a=N(o,s);Array.isArray(a)&&(a=a.map(u=>q(o,u))),r(e,["contents"],a)}const l=i(n,["config"]);return l!=null&&r(e,["config"],l),e}function js(o,n,e){const t={},s=i(n,["numberOfVideos"]);e!==void 0&&s!=null&&r(e,["parameters","sampleCount"],s);const l=i(n,["outputGcsUri"]);e!==void 0&&l!=null&&r(e,["parameters","storageUri"],l);const a=i(n,["fps"]);e!==void 0&&a!=null&&r(e,["parameters","fps"],a);const u=i(n,["durationSeconds"]);e!==void 0&&u!=null&&r(e,["parameters","durationSeconds"],u);const c=i(n,["seed"]);e!==void 0&&c!=null&&r(e,["parameters","seed"],c);const d=i(n,["aspectRatio"]);e!==void 0&&d!=null&&r(e,["parameters","aspectRatio"],d);const f=i(n,["resolution"]);e!==void 0&&f!=null&&r(e,["parameters","resolution"],f);const p=i(n,["personGeneration"]);e!==void 0&&p!=null&&r(e,["parameters","personGeneration"],p);const m=i(n,["pubsubTopic"]);e!==void 0&&m!=null&&r(e,["parameters","pubsubTopic"],m);const g=i(n,["negativePrompt"]);e!==void 0&&g!=null&&r(e,["parameters","negativePrompt"],g);const h=i(n,["enhancePrompt"]);return e!==void 0&&h!=null&&r(e,["parameters","enhancePrompt"],h),t}function er(o,n){const e={},t=i(n,["model"]);t!=null&&r(e,["_url","model"],I(o,t));const s=i(n,["prompt"]);s!=null&&r(e,["instances[0]","prompt"],s);const l=i(n,["image"]);l!=null&&r(e,["instances[0]","image"],Me(o,l));const a=i(n,["config"]);return a!=null&&r(e,["config"],js(o,a,e)),e}function nr(o,n){const e={},t=i(n,["data"]);t!=null&&r(e,["data"],t);const s=i(n,["mimeType"]);return s!=null&&r(e,["mimeType"],s),e}function tr(o,n){const e={},t=i(n,["thought"]);t!=null&&r(e,["thought"],t);const s=i(n,["inlineData"]);s!=null&&r(e,["inlineData"],nr(o,s));const l=i(n,["codeExecutionResult"]);l!=null&&r(e,["codeExecutionResult"],l);const a=i(n,["executableCode"]);a!=null&&r(e,["executableCode"],a);const u=i(n,["fileData"]);u!=null&&r(e,["fileData"],u);const c=i(n,["functionCall"]);c!=null&&r(e,["functionCall"],c);const d=i(n,["functionResponse"]);d!=null&&r(e,["functionResponse"],d);const f=i(n,["text"]);return f!=null&&r(e,["text"],f),e}function or(o,n){const e={},t=i(n,["parts"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(a=>tr(o,a))),r(e,["parts"],l)}const s=i(n,["role"]);return s!=null&&r(e,["role"],s),e}function ir(o,n){const e={},t=i(n,["citationSources"]);return t!=null&&r(e,["citations"],t),e}function sr(o,n){const e={},t=i(n,["content"]);t!=null&&r(e,["content"],or(o,t));const s=i(n,["citationMetadata"]);s!=null&&r(e,["citationMetadata"],ir(o,s));const l=i(n,["tokenCount"]);l!=null&&r(e,["tokenCount"],l);const a=i(n,["finishReason"]);a!=null&&r(e,["finishReason"],a);const u=i(n,["avgLogprobs"]);u!=null&&r(e,["avgLogprobs"],u);const c=i(n,["groundingMetadata"]);c!=null&&r(e,["groundingMetadata"],c);const d=i(n,["index"]);d!=null&&r(e,["index"],d);const f=i(n,["logprobsResult"]);f!=null&&r(e,["logprobsResult"],f);const p=i(n,["safetyRatings"]);return p!=null&&r(e,["safetyRatings"],p),e}function Dn(o,n){const e={},t=i(n,["candidates"]);if(t!=null){let u=t;Array.isArray(u)&&(u=u.map(c=>sr(o,c))),r(e,["candidates"],u)}const s=i(n,["modelVersion"]);s!=null&&r(e,["modelVersion"],s);const l=i(n,["promptFeedback"]);l!=null&&r(e,["promptFeedback"],l);const a=i(n,["usageMetadata"]);return a!=null&&r(e,["usageMetadata"],a),e}function rr(o,n){const e={},t=i(n,["values"]);return t!=null&&r(e,["values"],t),e}function lr(){return{}}function ar(o,n){const e={},t=i(n,["embeddings"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(a=>rr(o,a))),r(e,["embeddings"],l)}return i(n,["metadata"])!=null&&r(e,["metadata"],lr()),e}function ur(o,n){const e={},t=i(n,["bytesBase64Encoded"]);t!=null&&r(e,["imageBytes"],L(o,t));const s=i(n,["mimeType"]);return s!=null&&r(e,["mimeType"],s),e}function zn(o,n){const e={},t=i(n,["safetyAttributes","categories"]);t!=null&&r(e,["categories"],t);const s=i(n,["safetyAttributes","scores"]);s!=null&&r(e,["scores"],s);const l=i(n,["contentType"]);return l!=null&&r(e,["contentType"],l),e}function dr(o,n){const e={},t=i(n,["_self"]);t!=null&&r(e,["image"],ur(o,t));const s=i(n,["raiFilteredReason"]);s!=null&&r(e,["raiFilteredReason"],s);const l=i(n,["_self"]);return l!=null&&r(e,["safetyAttributes"],zn(o,l)),e}function cr(o,n){const e={},t=i(n,["predictions"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(a=>dr(o,a))),r(e,["generatedImages"],l)}const s=i(n,["positivePromptSafetyAttributes"]);return s!=null&&r(e,["positivePromptSafetyAttributes"],zn(o,s)),e}function fr(o,n){const e={},t=i(n,["baseModel"]);t!=null&&r(e,["baseModel"],t);const s=i(n,["createTime"]);s!=null&&r(e,["createTime"],s);const l=i(n,["updateTime"]);return l!=null&&r(e,["updateTime"],l),e}function he(o,n){const e={},t=i(n,["name"]);t!=null&&r(e,["name"],t);const s=i(n,["displayName"]);s!=null&&r(e,["displayName"],s);const l=i(n,["description"]);l!=null&&r(e,["description"],l);const a=i(n,["version"]);a!=null&&r(e,["version"],a);const u=i(n,["_self"]);u!=null&&r(e,["tunedModelInfo"],fr(o,u));const c=i(n,["inputTokenLimit"]);c!=null&&r(e,["inputTokenLimit"],c);const d=i(n,["outputTokenLimit"]);d!=null&&r(e,["outputTokenLimit"],d);const f=i(n,["supportedGenerationMethods"]);return f!=null&&r(e,["supportedActions"],f),e}function pr(o,n){const e={},t=i(n,["nextPageToken"]);t!=null&&r(e,["nextPageToken"],t);const s=i(n,["_self"]);if(s!=null){let l=Yn(o,s);Array.isArray(l)&&(l=l.map(a=>he(o,a))),r(e,["models"],l)}return e}function mr(){return{}}function gr(o,n){const e={},t=i(n,["totalTokens"]);t!=null&&r(e,["totalTokens"],t);const s=i(n,["cachedContentTokenCount"]);return s!=null&&r(e,["cachedContentTokenCount"],s),e}function hr(o,n){const e={},t=i(n,["video","uri"]);t!=null&&r(e,["uri"],t);const s=i(n,["video","encodedVideo"]);s!=null&&r(e,["videoBytes"],L(o,s));const l=i(n,["encoding"]);return l!=null&&r(e,["mimeType"],l),e}function yr(o,n){const e={},t=i(n,["_self"]);return t!=null&&r(e,["video"],hr(o,t)),e}function Tr(o,n){const e={},t=i(n,["generatedSamples"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(u=>yr(o,u))),r(e,["generatedVideos"],a)}const s=i(n,["raiMediaFilteredCount"]);s!=null&&r(e,["raiMediaFilteredCount"],s);const l=i(n,["raiMediaFilteredReasons"]);return l!=null&&r(e,["raiMediaFilteredReasons"],l),e}function Cr(o,n){const e={},t=i(n,["name"]);t!=null&&r(e,["name"],t);const s=i(n,["metadata"]);s!=null&&r(e,["metadata"],s);const l=i(n,["done"]);l!=null&&r(e,["done"],l);const a=i(n,["error"]);a!=null&&r(e,["error"],a);const u=i(n,["response","generateVideoResponse"]);return u!=null&&r(e,["response"],Tr(o,u)),e}function Er(o,n){const e={},t=i(n,["displayName"]);t!=null&&r(e,["displayName"],t);const s=i(n,["data"]);s!=null&&r(e,["data"],s);const l=i(n,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function vr(o,n){const e={},t=i(n,["videoMetadata"]);t!=null&&r(e,["videoMetadata"],t);const s=i(n,["thought"]);s!=null&&r(e,["thought"],s);const l=i(n,["inlineData"]);l!=null&&r(e,["inlineData"],Er(o,l));const a=i(n,["codeExecutionResult"]);a!=null&&r(e,["codeExecutionResult"],a);const u=i(n,["executableCode"]);u!=null&&r(e,["executableCode"],u);const c=i(n,["fileData"]);c!=null&&r(e,["fileData"],c);const d=i(n,["functionCall"]);d!=null&&r(e,["functionCall"],d);const f=i(n,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const p=i(n,["text"]);return p!=null&&r(e,["text"],p),e}function _r(o,n){const e={},t=i(n,["parts"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(a=>vr(o,a))),r(e,["parts"],l)}const s=i(n,["role"]);return s!=null&&r(e,["role"],s),e}function Ir(o,n){const e={},t=i(n,["citations"]);return t!=null&&r(e,["citations"],t),e}function Sr(o,n){const e={},t=i(n,["content"]);t!=null&&r(e,["content"],_r(o,t));const s=i(n,["citationMetadata"]);s!=null&&r(e,["citationMetadata"],Ir(o,s));const l=i(n,["finishMessage"]);l!=null&&r(e,["finishMessage"],l);const a=i(n,["finishReason"]);a!=null&&r(e,["finishReason"],a);const u=i(n,["avgLogprobs"]);u!=null&&r(e,["avgLogprobs"],u);const c=i(n,["groundingMetadata"]);c!=null&&r(e,["groundingMetadata"],c);const d=i(n,["index"]);d!=null&&r(e,["index"],d);const f=i(n,["logprobsResult"]);f!=null&&r(e,["logprobsResult"],f);const p=i(n,["safetyRatings"]);return p!=null&&r(e,["safetyRatings"],p),e}function xn(o,n){const e={},t=i(n,["candidates"]);if(t!=null){let d=t;Array.isArray(d)&&(d=d.map(f=>Sr(o,f))),r(e,["candidates"],d)}const s=i(n,["createTime"]);s!=null&&r(e,["createTime"],s);const l=i(n,["responseId"]);l!=null&&r(e,["responseId"],l);const a=i(n,["modelVersion"]);a!=null&&r(e,["modelVersion"],a);const u=i(n,["promptFeedback"]);u!=null&&r(e,["promptFeedback"],u);const c=i(n,["usageMetadata"]);return c!=null&&r(e,["usageMetadata"],c),e}function Ar(o,n){const e={},t=i(n,["truncated"]);t!=null&&r(e,["truncated"],t);const s=i(n,["token_count"]);return s!=null&&r(e,["tokenCount"],s),e}function Mr(o,n){const e={},t=i(n,["values"]);t!=null&&r(e,["values"],t);const s=i(n,["statistics"]);return s!=null&&r(e,["statistics"],Ar(o,s)),e}function Pr(o,n){const e={},t=i(n,["billableCharacterCount"]);return t!=null&&r(e,["billableCharacterCount"],t),e}function Rr(o,n){const e={},t=i(n,["predictions[]","embeddings"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(a=>Mr(o,a))),r(e,["embeddings"],l)}const s=i(n,["metadata"]);return s!=null&&r(e,["metadata"],Pr(o,s)),e}function Dr(o,n){const e={},t=i(n,["gcsUri"]);t!=null&&r(e,["gcsUri"],t);const s=i(n,["bytesBase64Encoded"]);s!=null&&r(e,["imageBytes"],L(o,s));const l=i(n,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function bn(o,n){const e={},t=i(n,["safetyAttributes","categories"]);t!=null&&r(e,["categories"],t);const s=i(n,["safetyAttributes","scores"]);s!=null&&r(e,["scores"],s);const l=i(n,["contentType"]);return l!=null&&r(e,["contentType"],l),e}function Pe(o,n){const e={},t=i(n,["_self"]);t!=null&&r(e,["image"],Dr(o,t));const s=i(n,["raiFilteredReason"]);s!=null&&r(e,["raiFilteredReason"],s);const l=i(n,["_self"]);l!=null&&r(e,["safetyAttributes"],bn(o,l));const a=i(n,["prompt"]);return a!=null&&r(e,["enhancedPrompt"],a),e}function xr(o,n){const e={},t=i(n,["predictions"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(a=>Pe(o,a))),r(e,["generatedImages"],l)}const s=i(n,["positivePromptSafetyAttributes"]);return s!=null&&r(e,["positivePromptSafetyAttributes"],bn(o,s)),e}function Nr(o,n){const e={},t=i(n,["predictions"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(l=>Pe(o,l))),r(e,["generatedImages"],s)}return e}function wr(o,n){const e={},t=i(n,["predictions"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(l=>Pe(o,l))),r(e,["generatedImages"],s)}return e}function Lr(o,n){const e={},t=i(n,["endpoint"]);t!=null&&r(e,["name"],t);const s=i(n,["deployedModelId"]);return s!=null&&r(e,["deployedModelId"],s),e}function Vr(o,n){const e={},t=i(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&r(e,["baseModel"],t);const s=i(n,["createTime"]);s!=null&&r(e,["createTime"],s);const l=i(n,["updateTime"]);return l!=null&&r(e,["updateTime"],l),e}function Ur(o,n){const e={},t=i(n,["checkpointId"]);t!=null&&r(e,["checkpointId"],t);const s=i(n,["epoch"]);s!=null&&r(e,["epoch"],s);const l=i(n,["step"]);return l!=null&&r(e,["step"],l),e}function ye(o,n){const e={},t=i(n,["name"]);t!=null&&r(e,["name"],t);const s=i(n,["displayName"]);s!=null&&r(e,["displayName"],s);const l=i(n,["description"]);l!=null&&r(e,["description"],l);const a=i(n,["versionId"]);a!=null&&r(e,["version"],a);const u=i(n,["deployedModels"]);if(u!=null){let m=u;Array.isArray(m)&&(m=m.map(g=>Lr(o,g))),r(e,["endpoints"],m)}const c=i(n,["labels"]);c!=null&&r(e,["labels"],c);const d=i(n,["_self"]);d!=null&&r(e,["tunedModelInfo"],Vr(o,d));const f=i(n,["defaultCheckpointId"]);f!=null&&r(e,["defaultCheckpointId"],f);const p=i(n,["checkpoints"]);if(p!=null){let m=p;Array.isArray(m)&&(m=m.map(g=>Ur(o,g))),r(e,["checkpoints"],m)}return e}function Fr(o,n){const e={},t=i(n,["nextPageToken"]);t!=null&&r(e,["nextPageToken"],t);const s=i(n,["_self"]);if(s!=null){let l=Yn(o,s);Array.isArray(l)&&(l=l.map(a=>ye(o,a))),r(e,["models"],l)}return e}function kr(){return{}}function qr(o,n){const e={},t=i(n,["totalTokens"]);return t!=null&&r(e,["totalTokens"],t),e}function Gr(o,n){const e={},t=i(n,["tokensInfo"]);return t!=null&&r(e,["tokensInfo"],t),e}function Br(o,n){const e={},t=i(n,["gcsUri"]);t!=null&&r(e,["uri"],t);const s=i(n,["bytesBase64Encoded"]);s!=null&&r(e,["videoBytes"],L(o,s));const l=i(n,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function Hr(o,n){const e={},t=i(n,["_self"]);return t!=null&&r(e,["video"],Br(o,t)),e}function Jr(o,n){const e={},t=i(n,["videos"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(u=>Hr(o,u))),r(e,["generatedVideos"],a)}const s=i(n,["raiMediaFilteredCount"]);s!=null&&r(e,["raiMediaFilteredCount"],s);const l=i(n,["raiMediaFilteredReasons"]);return l!=null&&r(e,["raiMediaFilteredReasons"],l),e}function $r(o,n){const e={},t=i(n,["name"]);t!=null&&r(e,["name"],t);const s=i(n,["metadata"]);s!=null&&r(e,["metadata"],s);const l=i(n,["done"]);l!=null&&r(e,["done"],l);const a=i(n,["error"]);a!=null&&r(e,["error"],a);const u=i(n,["response"]);return u!=null&&r(e,["response"],Jr(o,u)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Yr="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Kr(o,n,e){const t=new ao;let s;if(e.data instanceof Blob?s=JSON.parse(await e.data.text()):s=JSON.parse(e.data),o.isVertexAI()){const l=Ui(o,s);Object.assign(t,l)}else{const l=Vi(o,s);Object.assign(t,l)}n(t)}class Wr{constructor(n,e,t){this.apiClient=n,this.auth=e,this.webSocketFactory=t}async connect(n){var e,t,s,l;const a=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let c;const d=Xr(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())c=`${a}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(d);else{const E=this.apiClient.getApiKey();c=`${a}/ws/google.ai.generativelanguage.${u}.GenerativeService.BidiGenerateContent?key=${E}`}let f=()=>{};const p=new Promise(E=>{f=E}),m=n.callbacks,g=function(){var E;(E=m==null?void 0:m.onopen)===null||E===void 0||E.call(m),f({})},h=this.apiClient,y={onopen:g,onmessage:E=>{Kr(h,m.onmessage,E)},onerror:(e=m==null?void 0:m.onerror)!==null&&e!==void 0?e:function(E){},onclose:(t=m==null?void 0:m.onclose)!==null&&t!==void 0?t:function(E){}},C=this.webSocketFactory.create(c,Or(d),y);C.connect(),await p;let v=I(this.apiClient,n.model);if(this.apiClient.isVertexAI()&&v.startsWith("publishers/")){const E=this.apiClient.getProject(),A=this.apiClient.getLocation();v=`projects/${E}/locations/${A}/`+v}let _={};this.apiClient.isVertexAI()&&((s=n.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(n.config===void 0?n.config={responseModalities:[ee.AUDIO]}:n.config.responseModalities=[ee.AUDIO]),!((l=n.config)===null||l===void 0)&&l.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const S={model:v,config:n.config,callbacks:n.callbacks};return this.apiClient.isVertexAI()?_=si(this.apiClient,S):_=ii(this.apiClient,S),delete _.config,C.send(JSON.stringify(_)),new br(C,this.apiClient)}}const zr={turnComplete:!0};class br{constructor(n,e){this.conn=n,this.apiClient=e}tLiveClientContent(n,e){if(e.turns!==null&&e.turns!==void 0){let t=[];try{t=N(n,e.turns),n.isVertexAI()?t=t.map(s=>q(n,s)):t=t.map(s=>re(n,s))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof e.turns}'`)}return{clientContent:{turns:t,turnComplete:e.turnComplete}}}return{clientContent:{turnComplete:e.turnComplete}}}tLiveClienttToolResponse(n,e){let t=[];if(e.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(e.functionResponses)?t=e.functionResponses:t=[e.functionResponses],t.length===0)throw new Error("functionResponses is required.");for(const l of t){if(typeof l!="object"||l===null||!("name"in l)||!("response"in l))throw new Error(`Could not parse function response, type '${typeof l}'.`);if(!n.isVertexAI()&&!("id"in l))throw new Error(Yr)}return{toolResponse:{functionResponses:t}}}sendClientContent(n){n=Object.assign(Object.assign({},zr),n);const e=this.tLiveClientContent(this.apiClient,n);this.conn.send(JSON.stringify(e))}sendRealtimeInput(n){let e={};this.apiClient.isVertexAI()?e={realtimeInput:ci(this.apiClient,n)}:e={realtimeInput:di(this.apiClient,n)},this.conn.send(JSON.stringify(e))}sendToolResponse(n){if(n.functionResponses==null)throw new Error("Tool response parameters are required.");const e=this.tLiveClienttToolResponse(this.apiClient,n);this.conn.send(JSON.stringify(e))}close(){this.conn.close()}}function Or(o){const n={};return o.forEach((e,t)=>{n[t]=e}),n}function Xr(o){const n=new Headers;for(const[e,t]of Object.entries(o))n.append(e,t);return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Zr extends K{constructor(n){super(),this.apiClient=n,this.generateContent=async e=>await this.generateContentInternal(e),this.generateContentStream=async e=>await this.generateContentStreamInternal(e),this.generateImages=async e=>await this.generateImagesInternal(e).then(t=>{var s;let l;const a=[];if(t!=null&&t.generatedImages)for(const c of t.generatedImages)c&&(c!=null&&c.safetyAttributes)&&((s=c==null?void 0:c.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?l=c==null?void 0:c.safetyAttributes:a.push(c);let u;return l?u={generatedImages:a,positivePromptSafetyAttributes:l}:u={generatedImages:a},u}),this.list=async e=>{var t;const a={config:Object.assign(Object.assign({},{queryBase:!0}),e==null?void 0:e.config)};if(this.apiClient.isVertexAI()&&!a.config.queryBase){if(!((t=a.config)===null||t===void 0)&&t.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");a.config.filter="labels.tune-type:*"}return new se(F.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(a),a)},this.editImage=async e=>{const t={model:e.model,prompt:e.prompt,referenceImages:[],config:e.config};return e.referenceImages&&e.referenceImages&&(t.referenceImages=e.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(t)},this.upscaleImage=async e=>{let t={numberOfImages:1,mode:"upscale"};e.config&&(t=Object.assign(Object.assign({},t),e.config));const s={model:e.model,image:e.image,upscaleFactor:e.upscaleFactor,config:t};return await this.upscaleImageInternal(s)}}async generateContentInternal(n){var e,t,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Rn(this.apiClient,n);return u=T("{model}:generateContent",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(f=>f.json()),a.then(f=>{const p=xn(this.apiClient,f),m=new W;return Object.assign(m,p),m})}else{const d=Pn(this.apiClient,n);return u=T("{model}:generateContent",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=Dn(this.apiClient,f),m=new W;return Object.assign(m,p),m})}}async generateContentStreamInternal(n){var e,t,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Rn(this.apiClient,n);u=T("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d.config,delete d._url,delete d._query;const f=this.apiClient;return a=f.requestStream({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}),a.then(function(p){return ne(this,arguments,function*(){var m,g,h,y;try{for(var C=!0,v=me(p),_;_=yield M(v.next()),m=_.done,!m;C=!0){y=_.value,C=!1;const E=xn(f,yield M(y.json())),A=new W;Object.assign(A,E),yield yield M(A)}}catch(S){g={error:S}}finally{try{!C&&!m&&(h=v.return)&&(yield M(h.call(v)))}finally{if(g)throw g.error}}})})}else{const d=Pn(this.apiClient,n);u=T("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d.config,delete d._url,delete d._query;const f=this.apiClient;return a=f.requestStream({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}),a.then(function(p){return ne(this,arguments,function*(){var m,g,h,y;try{for(var C=!0,v=me(p),_;_=yield M(v.next()),m=_.done,!m;C=!0){y=_.value,C=!1;const E=Dn(f,yield M(y.json())),A=new W;Object.assign(A,E),yield yield M(A)}}catch(S){g={error:S}}finally{try{!C&&!m&&(h=v.return)&&(yield M(h.call(v)))}finally{if(g)throw g.error}}})})}}async embedContent(n){var e,t,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=ws(this.apiClient,n);return u=T("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(f=>f.json()),a.then(f=>{const p=Rr(this.apiClient,f),m=new mn;return Object.assign(m,p),m})}else{const d=Zi(this.apiClient,n);return u=T("{model}:batchEmbedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=ar(this.apiClient,f),m=new mn;return Object.assign(m,p),m})}}async generateImagesInternal(n){var e,t,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Vs(this.apiClient,n);return u=T("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(f=>f.json()),a.then(f=>{const p=xr(this.apiClient,f),m=new gn;return Object.assign(m,p),m})}else{const d=ji(this.apiClient,n);return u=T("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=cr(this.apiClient,f),m=new gn;return Object.assign(m,p),m})}}async editImageInternal(n){var e,t;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=Hs(this.apiClient,n);return l=T("{model}:predict",u._url),a=u._query,delete u.config,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(c=>c.json()),s.then(c=>{const d=Nr(this.apiClient,c),f=new to;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(n){var e,t;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=$s(this.apiClient,n);return l=T("{model}:predict",u._url),a=u._query,delete u.config,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(c=>c.json()),s.then(c=>{const d=wr(this.apiClient,c),f=new oo;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(n){var e,t,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Ys(this.apiClient,n);return u=T("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(f=>f.json()),a.then(f=>ye(this.apiClient,f))}else{const d=es(this.apiClient,n);return u=T("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>he(this.apiClient,f))}}async listInternal(n){var e,t,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Ws(this.apiClient,n);return u=T("{models_url}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(f=>f.json()),a.then(f=>{const p=Fr(this.apiClient,f),m=new hn;return Object.assign(m,p),m})}else{const d=ts(this.apiClient,n);return u=T("{models_url}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=pr(this.apiClient,f),m=new hn;return Object.assign(m,p),m})}}async update(n){var e,t,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=bs(this.apiClient,n);return u=T("{model}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(f=>f.json()),a.then(f=>ye(this.apiClient,f))}else{const d=is(this.apiClient,n);return u=T("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>he(this.apiClient,f))}}async delete(n){var e,t,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Os(this.apiClient,n);return u=T("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(f=>f.json()),a.then(()=>{const f=kr(),p=new yn;return Object.assign(p,f),p})}else{const d=ss(this.apiClient,n);return u=T("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(()=>{const f=mr(),p=new yn;return Object.assign(p,f),p})}}async countTokens(n){var e,t,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Zs(this.apiClient,n);return u=T("{model}:countTokens",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(f=>f.json()),a.then(f=>{const p=qr(this.apiClient,f),m=new Tn;return Object.assign(m,p),m})}else{const d=ls(this.apiClient,n);return u=T("{model}:countTokens",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=gr(this.apiClient,f),m=new Tn;return Object.assign(m,p),m})}}async computeTokens(n){var e,t;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=Qs(this.apiClient,n);return l=T("{model}:computeTokens",u._url),a=u._query,delete u.config,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(c=>c.json()),s.then(c=>{const d=Gr(this.apiClient,c),f=new io;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(n){var e,t,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=er(this.apiClient,n);return u=T("{model}:predictLongRunning",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(f=>f.json()),a.then(f=>$r(this.apiClient,f))}else{const d=ds(this.apiClient,n);return u=T("{model}:predictLongRunning",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>Cr(this.apiClient,f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Qr(o,n){const e={},t=i(n,["operationName"]);t!=null&&r(e,["_url","operationName"],t);const s=i(n,["config"]);return s!=null&&r(e,["config"],s),e}function jr(o,n){const e={},t=i(n,["operationName"]);t!=null&&r(e,["_url","operationName"],t);const s=i(n,["config"]);return s!=null&&r(e,["config"],s),e}function el(o,n){const e={},t=i(n,["operationName"]);t!=null&&r(e,["operationName"],t);const s=i(n,["resourceName"]);s!=null&&r(e,["_url","resourceName"],s);const l=i(n,["config"]);return l!=null&&r(e,["config"],l),e}function nl(o,n){const e={},t=i(n,["video","uri"]);t!=null&&r(e,["uri"],t);const s=i(n,["video","encodedVideo"]);s!=null&&r(e,["videoBytes"],L(o,s));const l=i(n,["encoding"]);return l!=null&&r(e,["mimeType"],l),e}function tl(o,n){const e={},t=i(n,["_self"]);return t!=null&&r(e,["video"],nl(o,t)),e}function ol(o,n){const e={},t=i(n,["generatedSamples"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(u=>tl(o,u))),r(e,["generatedVideos"],a)}const s=i(n,["raiMediaFilteredCount"]);s!=null&&r(e,["raiMediaFilteredCount"],s);const l=i(n,["raiMediaFilteredReasons"]);return l!=null&&r(e,["raiMediaFilteredReasons"],l),e}function il(o,n){const e={},t=i(n,["name"]);t!=null&&r(e,["name"],t);const s=i(n,["metadata"]);s!=null&&r(e,["metadata"],s);const l=i(n,["done"]);l!=null&&r(e,["done"],l);const a=i(n,["error"]);a!=null&&r(e,["error"],a);const u=i(n,["response","generateVideoResponse"]);return u!=null&&r(e,["response"],ol(o,u)),e}function sl(o,n){const e={},t=i(n,["gcsUri"]);t!=null&&r(e,["uri"],t);const s=i(n,["bytesBase64Encoded"]);s!=null&&r(e,["videoBytes"],L(o,s));const l=i(n,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function rl(o,n){const e={},t=i(n,["_self"]);return t!=null&&r(e,["video"],sl(o,t)),e}function ll(o,n){const e={},t=i(n,["videos"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(u=>rl(o,u))),r(e,["generatedVideos"],a)}const s=i(n,["raiMediaFilteredCount"]);s!=null&&r(e,["raiMediaFilteredCount"],s);const l=i(n,["raiMediaFilteredReasons"]);return l!=null&&r(e,["raiMediaFilteredReasons"],l),e}function Nn(o,n){const e={},t=i(n,["name"]);t!=null&&r(e,["name"],t);const s=i(n,["metadata"]);s!=null&&r(e,["metadata"],s);const l=i(n,["done"]);l!=null&&r(e,["done"],l);const a=i(n,["error"]);a!=null&&r(e,["error"],a);const u=i(n,["response"]);return u!=null&&r(e,["response"],ll(o,u)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class al extends K{constructor(n){super(),this.apiClient=n}async getVideosOperation(n){const e=n.operation,t=n.config;if(e.name===void 0||e.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=e.name.split("/operations/")[0];let l;return t&&"httpOptions"in t&&(l=t.httpOptions),this.fetchPredictVideosOperationInternal({operationName:e.name,resourceName:s,config:{httpOptions:l}})}else return this.getVideosOperationInternal({operationName:e.name,config:t})}async getVideosOperationInternal(n){var e,t,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=jr(this.apiClient,n);return u=T("{operationName}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(f=>f.json()),a.then(f=>Nn(this.apiClient,f))}else{const d=Qr(this.apiClient,n);return u=T("{operationName}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>il(this.apiClient,f))}}async fetchPredictVideosOperationInternal(n){var e,t;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=el(this.apiClient,n);return l=T("{resourceName}:fetchPredictOperation",u._url),a=u._query,delete u.config,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(c=>c.json()),s.then(c=>Nn(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ul="Content-Type",dl="X-Server-Timeout",cl="User-Agent",fl="x-goog-api-client",pl="0.14.1",ml=`google-genai-sdk/${pl}`,gl="v1beta1",hl="v1beta",wn=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class On extends Error{constructor(n,e){e?super(n,{cause:e}):super(n,{cause:new Error().stack}),this.message=n,this.name="ClientError"}}class Te extends Error{constructor(n,e){e?super(n,{cause:e}):super(n,{cause:new Error().stack}),this.message=n,this.name="ServerError"}}class yl{constructor(n){var e,t;this.clientOptions=Object.assign(Object.assign({},n),{project:n.project,location:n.location,apiKey:n.apiKey,vertexai:n.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(e=this.clientOptions.apiVersion)!==null&&e!==void 0?e:gl,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:hl,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,n.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,n.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var n;return(n=this.clientOptions.vertexai)!==null&&n!==void 0?n:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(n){if(!n||n.baseUrl===void 0||n.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const t=[n.baseUrl.endsWith("/")?n.baseUrl.slice(0,-1):n.baseUrl];return n.apiVersion&&n.apiVersion!==""&&t.push(n.apiVersion),t.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const n=this.getBaseUrl(),e=new URL(n);return e.protocol=e.protocol=="http:"?"ws":"wss",e.toString()}setBaseUrl(n){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=n;else throw new Error("HTTP options are not correctly set.")}constructUrl(n,e,t){const s=[this.getRequestUrlInternal(e)];return t&&s.push(this.getBaseResourcePath()),n!==""&&s.push(n),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(n){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||n.path.startsWith("projects/")||n.httpMethod==="GET"&&n.path.startsWith("publishers/google/models"))}async request(n){let e=this.clientOptions.httpOptions;n.httpOptions&&(e=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const t=this.shouldPrependVertexProjectPath(n),s=this.constructUrl(n.path,e,t);if(n.queryParams)for(const[a,u]of Object.entries(n.queryParams))s.searchParams.append(a,String(u));let l={};if(n.httpMethod==="GET"){if(n.body&&n.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else l.body=n.body;return l=await this.includeExtraHttpOptionsToRequestInit(l,e,n.abortSignal),this.unaryApiCall(s,l,n.httpMethod)}patchHttpOptions(n,e){const t=JSON.parse(JSON.stringify(n));for(const[s,l]of Object.entries(e))typeof l=="object"?t[s]=Object.assign(Object.assign({},t[s]),l):l!==void 0&&(t[s]=l);return t}async requestStream(n){let e=this.clientOptions.httpOptions;n.httpOptions&&(e=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const t=this.shouldPrependVertexProjectPath(n),s=this.constructUrl(n.path,e,t);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let l={};return l.body=n.body,l=await this.includeExtraHttpOptionsToRequestInit(l,e,n.abortSignal),this.streamApiCall(s,l,n.httpMethod)}async includeExtraHttpOptionsToRequestInit(n,e,t){if(e&&e.timeout||t){const s=new AbortController,l=s.signal;e.timeout&&(e==null?void 0:e.timeout)>0&&setTimeout(()=>s.abort(),e.timeout),t&&t.addEventListener("abort",()=>{s.abort()}),n.signal=l}return n.headers=await this.getHeadersInternal(e),n}async unaryApiCall(n,e,t){return this.apiCall(n.toString(),Object.assign(Object.assign({},e),{method:t})).then(async s=>(await Ln(s),new pe(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(n,e,t){return this.apiCall(n.toString(),Object.assign(Object.assign({},e),{method:t})).then(async s=>(await Ln(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(n){var e;return ne(this,arguments,function*(){const s=(e=n==null?void 0:n.body)===null||e===void 0?void 0:e.getReader(),l=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let a="";for(;;){const{done:u,value:c}=yield M(s.read());if(u){if(a.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=l.decode(c);try{const p=JSON.parse(d);if("error"in p){const m=JSON.parse(JSON.stringify(p.error)),g=m.status,h=m.code,y=`got status: ${g}. ${JSON.stringify(p)}`;if(h>=400&&h<500)throw new On(y);if(h>=500&&h<600)throw new Te(y)}}catch(p){const m=p;if(m.name==="ClientError"||m.name==="ServerError")throw p}a+=d;let f=a.match(wn);for(;f;){const p=f[1];try{const m=new Response(p,{headers:n==null?void 0:n.headers,status:n==null?void 0:n.status,statusText:n==null?void 0:n.statusText});yield yield M(new pe(m)),a=a.slice(f[0].length),f=a.match(wn)}catch(m){throw new Error(`exception parsing stream chunk ${p}. ${m}`)}}}}finally{s.releaseLock()}})}async apiCall(n,e){return fetch(n,e).catch(t=>{throw new Error(`exception ${t} sending request`)})}getDefaultHeaders(){const n={},e=ml+" "+this.clientOptions.userAgentExtra;return n[cl]=e,n[fl]=e,n[ul]="application/json",n}async getHeadersInternal(n){const e=new Headers;if(n&&n.headers){for(const[t,s]of Object.entries(n.headers))e.append(t,s);n.timeout&&n.timeout>0&&e.append(dl,String(Math.ceil(n.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(e),e}async uploadFile(n,e){var t;const s={};e!=null&&(s.mimeType=e.mimeType,s.name=e.name,s.displayName=e.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const l=this.clientOptions.uploader,a=await l.stat(n);s.sizeBytes=String(a.size);const u=(t=e==null?void 0:e.mimeType)!==null&&t!==void 0?t:a.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=u;const c=await this.fetchUploadUrl(s,e);return l.upload(n,c,this)}async downloadFile(n){await this.clientOptions.downloader.download(n,this)}async fetchUploadUrl(n,e){var t;let s={};e!=null&&e.httpOptions?s=e.httpOptions:s={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${n.mimeType}`}};const l={file:n},a=await this.request({path:T("upload/v1beta/files",l._url),body:JSON.stringify(l),httpMethod:"POST",httpOptions:s});if(!a||!(a!=null&&a.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const u=(t=a==null?void 0:a.headers)===null||t===void 0?void 0:t["x-goog-upload-url"];if(u===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function Ln(o){var n;if(o===void 0)throw new Te("response is undefined");if(!o.ok){const e=o.status,t=o.statusText;let s;!((n=o.headers.get("content-type"))===null||n===void 0)&&n.includes("application/json")?s=await o.json():s={error:{message:await o.text(),code:o.status,status:o.statusText}};const l=`got status: ${e} ${t}. ${JSON.stringify(s)}`;throw e>=400&&e<500?new On(l):e>=500&&e<600?new Te(l):new Error(l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Tl(o,n){const e={},t=i(n,["name"]);t!=null&&r(e,["_url","name"],t);const s=i(n,["config"]);return s!=null&&r(e,["config"],s),e}function Cl(o,n,e){const t={},s=i(n,["pageSize"]);e!==void 0&&s!=null&&r(e,["_query","pageSize"],s);const l=i(n,["pageToken"]);e!==void 0&&l!=null&&r(e,["_query","pageToken"],l);const a=i(n,["filter"]);return e!==void 0&&a!=null&&r(e,["_query","filter"],a),t}function El(o,n){const e={},t=i(n,["config"]);return t!=null&&r(e,["config"],Cl(o,t,e)),e}function vl(o,n){const e={},t=i(n,["textInput"]);t!=null&&r(e,["textInput"],t);const s=i(n,["output"]);return s!=null&&r(e,["output"],s),e}function _l(o,n){const e={};if(i(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=i(n,["examples"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(l=>vl(o,l))),r(e,["examples","examples"],s)}return e}function Il(o,n,e){const t={};if(i(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=i(n,["tunedModelDisplayName"]);if(e!==void 0&&s!=null&&r(e,["displayName"],s),i(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const l=i(n,["epochCount"]);e!==void 0&&l!=null&&r(e,["tuningTask","hyperparameters","epochCount"],l);const a=i(n,["learningRateMultiplier"]);if(a!=null&&r(t,["tuningTask","hyperparameters","learningRateMultiplier"],a),i(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(i(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const u=i(n,["batchSize"]);e!==void 0&&u!=null&&r(e,["tuningTask","hyperparameters","batchSize"],u);const c=i(n,["learningRate"]);return e!==void 0&&c!=null&&r(e,["tuningTask","hyperparameters","learningRate"],c),t}function Sl(o,n){const e={},t=i(n,["baseModel"]);t!=null&&r(e,["baseModel"],t);const s=i(n,["trainingDataset"]);s!=null&&r(e,["tuningTask","trainingData"],_l(o,s));const l=i(n,["config"]);return l!=null&&r(e,["config"],Il(o,l,e)),e}function Al(o,n){const e={},t=i(n,["name"]);t!=null&&r(e,["_url","name"],t);const s=i(n,["config"]);return s!=null&&r(e,["config"],s),e}function Ml(o,n,e){const t={},s=i(n,["pageSize"]);e!==void 0&&s!=null&&r(e,["_query","pageSize"],s);const l=i(n,["pageToken"]);e!==void 0&&l!=null&&r(e,["_query","pageToken"],l);const a=i(n,["filter"]);return e!==void 0&&a!=null&&r(e,["_query","filter"],a),t}function Pl(o,n){const e={},t=i(n,["config"]);return t!=null&&r(e,["config"],Ml(o,t,e)),e}function Rl(o,n,e){const t={},s=i(n,["gcsUri"]);if(e!==void 0&&s!=null&&r(e,["supervisedTuningSpec","trainingDatasetUri"],s),i(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return t}function Dl(o,n){const e={},t=i(n,["gcsUri"]);return t!=null&&r(e,["validationDatasetUri"],t),e}function xl(o,n,e){const t={},s=i(n,["validationDataset"]);e!==void 0&&s!=null&&r(e,["supervisedTuningSpec"],Dl(o,s));const l=i(n,["tunedModelDisplayName"]);e!==void 0&&l!=null&&r(e,["tunedModelDisplayName"],l);const a=i(n,["description"]);e!==void 0&&a!=null&&r(e,["description"],a);const u=i(n,["epochCount"]);e!==void 0&&u!=null&&r(e,["supervisedTuningSpec","hyperParameters","epochCount"],u);const c=i(n,["learningRateMultiplier"]);e!==void 0&&c!=null&&r(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c);const d=i(n,["exportLastCheckpointOnly"]);e!==void 0&&d!=null&&r(e,["supervisedTuningSpec","exportLastCheckpointOnly"],d);const f=i(n,["adapterSize"]);if(e!==void 0&&f!=null&&r(e,["supervisedTuningSpec","hyperParameters","adapterSize"],f),i(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(i(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return t}function Nl(o,n){const e={},t=i(n,["baseModel"]);t!=null&&r(e,["baseModel"],t);const s=i(n,["trainingDataset"]);s!=null&&r(e,["supervisedTuningSpec","trainingDatasetUri"],Rl(o,s,e));const l=i(n,["config"]);return l!=null&&r(e,["config"],xl(o,l,e)),e}function wl(o,n){const e={},t=i(n,["name"]);t!=null&&r(e,["model"],t);const s=i(n,["name"]);return s!=null&&r(e,["endpoint"],s),e}function Xn(o,n){const e={},t=i(n,["name"]);t!=null&&r(e,["name"],t);const s=i(n,["state"]);s!=null&&r(e,["state"],Hn(o,s));const l=i(n,["createTime"]);l!=null&&r(e,["createTime"],l);const a=i(n,["tuningTask","startTime"]);a!=null&&r(e,["startTime"],a);const u=i(n,["tuningTask","completeTime"]);u!=null&&r(e,["endTime"],u);const c=i(n,["updateTime"]);c!=null&&r(e,["updateTime"],c);const d=i(n,["description"]);d!=null&&r(e,["description"],d);const f=i(n,["baseModel"]);f!=null&&r(e,["baseModel"],f);const p=i(n,["_self"]);p!=null&&r(e,["tunedModel"],wl(o,p));const m=i(n,["distillationSpec"]);m!=null&&r(e,["distillationSpec"],m);const g=i(n,["experiment"]);g!=null&&r(e,["experiment"],g);const h=i(n,["labels"]);h!=null&&r(e,["labels"],h);const y=i(n,["pipelineJob"]);y!=null&&r(e,["pipelineJob"],y);const C=i(n,["tunedModelDisplayName"]);return C!=null&&r(e,["tunedModelDisplayName"],C),e}function Ll(o,n){const e={},t=i(n,["nextPageToken"]);t!=null&&r(e,["nextPageToken"],t);const s=i(n,["tunedModels"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>Xn(o,a))),r(e,["tuningJobs"],l)}return e}function Vl(o,n){const e={},t=i(n,["name"]);t!=null&&r(e,["name"],t);const s=i(n,["metadata"]);s!=null&&r(e,["metadata"],s);const l=i(n,["done"]);l!=null&&r(e,["done"],l);const a=i(n,["error"]);return a!=null&&r(e,["error"],a),e}function Ul(o,n){const e={},t=i(n,["checkpointId"]);t!=null&&r(e,["checkpointId"],t);const s=i(n,["epoch"]);s!=null&&r(e,["epoch"],s);const l=i(n,["step"]);l!=null&&r(e,["step"],l);const a=i(n,["endpoint"]);return a!=null&&r(e,["endpoint"],a),e}function Fl(o,n){const e={},t=i(n,["model"]);t!=null&&r(e,["model"],t);const s=i(n,["endpoint"]);s!=null&&r(e,["endpoint"],s);const l=i(n,["checkpoints"]);if(l!=null){let a=l;Array.isArray(a)&&(a=a.map(u=>Ul(o,u))),r(e,["checkpoints"],a)}return e}function Ce(o,n){const e={},t=i(n,["name"]);t!=null&&r(e,["name"],t);const s=i(n,["state"]);s!=null&&r(e,["state"],Hn(o,s));const l=i(n,["createTime"]);l!=null&&r(e,["createTime"],l);const a=i(n,["startTime"]);a!=null&&r(e,["startTime"],a);const u=i(n,["endTime"]);u!=null&&r(e,["endTime"],u);const c=i(n,["updateTime"]);c!=null&&r(e,["updateTime"],c);const d=i(n,["error"]);d!=null&&r(e,["error"],d);const f=i(n,["description"]);f!=null&&r(e,["description"],f);const p=i(n,["baseModel"]);p!=null&&r(e,["baseModel"],p);const m=i(n,["tunedModel"]);m!=null&&r(e,["tunedModel"],Fl(o,m));const g=i(n,["supervisedTuningSpec"]);g!=null&&r(e,["supervisedTuningSpec"],g);const h=i(n,["tuningDataStats"]);h!=null&&r(e,["tuningDataStats"],h);const y=i(n,["encryptionSpec"]);y!=null&&r(e,["encryptionSpec"],y);const C=i(n,["partnerModelTuningSpec"]);C!=null&&r(e,["partnerModelTuningSpec"],C);const v=i(n,["distillationSpec"]);v!=null&&r(e,["distillationSpec"],v);const _=i(n,["experiment"]);_!=null&&r(e,["experiment"],_);const S=i(n,["labels"]);S!=null&&r(e,["labels"],S);const E=i(n,["pipelineJob"]);E!=null&&r(e,["pipelineJob"],E);const A=i(n,["tunedModelDisplayName"]);return A!=null&&r(e,["tunedModelDisplayName"],A),e}function kl(o,n){const e={},t=i(n,["nextPageToken"]);t!=null&&r(e,["nextPageToken"],t);const s=i(n,["tuningJobs"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>Ce(o,a))),r(e,["tuningJobs"],l)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ql extends K{constructor(n){super(),this.apiClient=n,this.get=async e=>await this.getInternal(e),this.list=async(e={})=>new se(F.PAGED_ITEM_TUNING_JOBS,t=>this.listInternal(t),await this.listInternal(e),e),this.tune=async e=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(e);{const t=await this.tuneMldevInternal(e);let s="";return t.metadata!==void 0&&t.metadata.tunedModel!==void 0?s=t.metadata.tunedModel:t.name!==void 0&&t.name.includes("/operations/")&&(s=t.name.split("/operations/")[0]),{name:s,state:fe.JOB_STATE_QUEUED}}}}async getInternal(n){var e,t,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Al(this.apiClient,n);return u=T("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(f=>f.json()),a.then(f=>Ce(this.apiClient,f))}else{const d=Tl(this.apiClient,n);return u=T("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>Xn(this.apiClient,f))}}async listInternal(n){var e,t,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Pl(this.apiClient,n);return u=T("tuningJobs",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(f=>f.json()),a.then(f=>{const p=kl(this.apiClient,f),m=new Cn;return Object.assign(m,p),m})}else{const d=El(this.apiClient,n);return u=T("tunedModels",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=Ll(this.apiClient,f),m=new Cn;return Object.assign(m,p),m})}}async tuneInternal(n){var e,t;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=Nl(this.apiClient,n);return l=T("tuningJobs",u._url),a=u._query,delete u.config,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(c=>c.json()),s.then(c=>Ce(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(n){var e,t;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Sl(this.apiClient,n);return l=T("tunedModels",u._url),a=u._query,delete u.config,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=n.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(t=n.config)===null||t===void 0?void 0:t.abortSignal}).then(c=>c.json()),s.then(c=>Vl(this.apiClient,c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Gl{async download(n,e){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const Bl=1024*1024*8,Hl=3,Jl=1e3,$l=2,ue="x-goog-upload-status";async function Yl(o,n,e){var t,s,l;let a=0,u=0,c=new pe(new Response),d="upload";for(a=o.size;u<a;){const p=Math.min(Bl,a-u),m=o.slice(u,u+p);u+p>=a&&(d+=", finalize");let g=0,h=Jl;for(;g<Hl&&(c=await e.request({path:"",body:m,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:n,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(u),"Content-Length":String(p)}}}),!(!((t=c==null?void 0:c.headers)===null||t===void 0)&&t[ue]));)g++,await Wl(h),h=h*$l;if(u+=p,((s=c==null?void 0:c.headers)===null||s===void 0?void 0:s[ue])!=="active")break;if(a<=u)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const f=await(c==null?void 0:c.json());if(((l=c==null?void 0:c.headers)===null||l===void 0?void 0:l[ue])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return f.file}async function Kl(o){return{size:o.size,type:o.type}}function Wl(o){return new Promise(n=>setTimeout(n,o))}class zl{async upload(n,e,t){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await Yl(n,e,t)}async stat(n){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await Kl(n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class bl{create(n,e,t){return new Ol(n,e,t)}}class Ol{constructor(n,e,t){this.url=n,this.headers=e,this.callbacks=t}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(n){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(n)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Vn="x-goog-api-key";class Xl{constructor(n){this.apiKey=n}async addAuthHeaders(n){n.get(Vn)===null&&n.append(Vn,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Zl="gl-node/";class Ql{constructor(n){var e;if(n.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(n.project||n.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(e=n.vertexai)!==null&&e!==void 0?e:!1,this.apiKey=n.apiKey;const t=rt(n,void 0,void 0);t&&(n.httpOptions?n.httpOptions.baseUrl=t:n.httpOptions={baseUrl:t}),this.apiVersion=n.apiVersion;const s=new Xl(this.apiKey);this.apiClient=new yl({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:n.httpOptions,userAgentExtra:Zl+"web",uploader:new zl,downloader:new Gl}),this.models=new Zr(this.apiClient),this.live=new Wr(this.apiClient,s,new bl),this.chats=new mo(this.models,this.apiClient),this.caches=new uo(this.apiClient),this.files=new Po(this.apiClient),this.operations=new al(this.apiClient),this.tunings=new ql(this.apiClient)}}/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
 */const jl="https://paypal.me/ausonix?locale.x=es_ES&country.x=ES",$=document.getElementById("chat-history"),Zn=document.getElementById("chat-form"),te=document.getElementById("chat-input"),ea=Zn.querySelector('button[type="submit"]'),na=document.getElementById("loading"),Qn=document.getElementById("support-btn"),jn=document.getElementById("analyze-btn"),Y=document.getElementById("stats-modal"),Ee=document.getElementById("stats-form"),et=document.getElementById("screenshot-form"),ve=document.getElementById("screenshot-input"),Q=document.getElementById("screenshot-preview"),_e=document.getElementById("file-name-display"),nt=document.getElementById("replay-form"),ta=document.getElementById("replay-input"),oa=document.querySelector(".modal-tabs"),ia=document.querySelectorAll(".modal-cancel-btn"),Ie=document.getElementById("donation-modal"),sa=document.getElementById("close-donation-modal"),ra=document.getElementById("paypal-link-modal"),Se=document.getElementById("donation-banner"),la=document.getElementById("close-donation-banner");let O=0,Ae=!1;const aa=`Eres un agente de IA experto en Counter-Strike 2. Tu nombre es "CS2 Performance Analyst". Tu única función es analizar las estadísticas de rendimiento o los resúmenes de partidas que los usuarios te proporcionan y darles coaching personalizado de nivel profesional. Todas tus funciones son gratuitas.

**Reglas estrictas:**
1.  **NO PUEDES ACCEDER A ENLACES EXTERNOS.** Nunca intentes visitar URLs. Si un usuario te envía un enlace, debes responder amablemente: "Lo siento, no puedo acceder a enlaces externos. Por favor, usa el botón 'ANALIZAR RENDIMIENTO' para introducir tus datos o el resumen de tu partida."
2.  Tu análisis se basa **exclusivamente** en los datos que el usuario introduce y en tu base de conocimientos tácticos.
3.  Mantén siempre un tono de entrenador: motivador, analítico, claro y positivo.
4.  Adapta tus consejos al nivel del jugador basándote en los datos. Para principiantes, enfócate en fundamentos. Para avanzados, introduce conceptos de nivel profesional de tu base de conocimientos.
5.  **Utiliza activamente la "Base de Conocimientos Tácticos"** para dar profundidad y contexto a tus análisis. Compara las jugadas del usuario con las estrategias de los profesionales.
6.  **Habla en el idioma del usuario.** Si el usuario te escribe en español, responde en español. Si escribe en inglés, responde en inglés.

---

**Base de Conocimientos Tácticos (Análisis de Majors):**
Usa estos principios, extraídos del análisis de más de 10 partidas de Majors (Copenhagen 2024, Paris 2023), para enriquecer tus análisis, ofreciendo consejos que reflejen las estrategias de los mejores equipos del mundo.

*   **Filosofía de Entry-Fragging (Estilo 'donk', Team Spirit):** Un entry-fragger no solo busca kills, sino que crea espacio con agresividad controlada. Su objetivo es romper la defensa y dar información. Analiza si el jugador tiene el potencial para un 'entry' hiper-agresivo. Si es así, recomienda practicar rutas de entrada rápidas y duelos de confianza para abrir espacios.
*   **El AWP Híbrido (Estilo 'ZywOo', Vitality/NAVI):** Un AWPer de élite no es estático. Debe saber reposicionarse, usar rifles eficazmente y tener impacto incluso sin el AWP. Evalúa si el AWPer usuario es unidimensional. Aconséjale practicar el reposicionamiento tras un disparo y tener un rifle sólido para rondas de semi-compra.
*   **El Lurker de Alto Impacto (Estilo 'ropz', FaZe Clan):** Lurkear no es esconderse. Es aplicar presión en el lado opuesto del mapa, cortar rotaciones y explotar timings. Si un usuario tiene éxito en los flancos, guíale para que perfeccione su lurking, explicando la importancia de los timings y la información sonora.
*   **Gestión Económica y el 'Jame Time' (Estilo 'Jame', Virtus.pro):** A veces, la mejor jugada es no jugar. Sobrevivir con un AWP o un rifle valioso en una ronda perdida garantiza una mejor economía para la siguiente. Enseña al jugador a reconocer rondas insalvables (ej: 2v5 sin bomba plantada) y la importancia estratégica de salvar el equipo.
*   **Control de Mapa y Utilidad Coordinada (Estilo FaZe Clan/Vitality):** Los equipos top usan la utilidad no solo para ejecutar, sino para tomar control de zonas clave (ej: control de medio en Mirage, banana en Inferno). Analiza el daño de utilidad. Si es bajo, proporciona ejemplos de smokes o molotovs cruciales para el mapa más jugado del usuario, explicando CÓMO y POR QUÉ ese lanzamiento gana espacio.
*   **Adaptabilidad en Rondas de Pistola:** La victoria en rondas de pistola a menudo viene de una estrategia audaz y coordinada (ej: el "Glock train" o un stack defensivo sorpresa). Analiza las tácticas en rondas iniciales y sugiere alternativas a las estrategias estándar.
*   **El Poder del Mid-Round Call (IGLs como 'apEX' o 'Aleksib'):** Las mejores decisiones se toman a mitad de ronda, adaptándose a la información obtenida. Al analizar replays, evalúa las decisiones del jugador tras el primer duelo. ¿Se adapta o sigue un plan rígido? Aconséjale jugar más reactivamente basándose en las bajas del feed.

---

**Flujo de análisis de Estadísticas de Leetify (Últimas 30 partidas):**
-   **Datos de entrada:** Recibirás un conjunto de estadísticas detalladas de Leetify. Debes analizarlas en profundidad.
-   **Análisis experto:**
    -   **Ratings (Leetify/HLTV):** Son el resumen del impacto. Un rating bajo (ej. < 0) en Leetify indica un impacto negativo en las rondas.
    -   **K/D y ADR:** Correlaciónalos. Un K/D > 1.0 pero un ADR < 70 puede indicar "exit frags" de bajo impacto. Compara con "Jame Time". Un ADR > 85 con un K/D < 1.0 puede indicar que el jugador causa mucho daño pero no asegura las kills.
    -   **Duelos de Apertura:** Es una métrica CRUCIAL. Un Success Rate bajo (< 45%) es un área crítica a mejorar para cualquier rol. Un "Traded when you die" bajo (< 20%) indica mal posicionamiento o falta de juego en equipo. Relaciona esto con el estilo "donk" para entries.
    -   **Clutching:** Un Win Rate alto en 1v1 es fundamental. Analiza si el jugador mantiene la calma.
    -   **Trades (Traded Deaths vs Trade Kills):** Esto mide el juego en equipo. Un bajo "Success by Teammate" en Traded Deaths pero un alto "Your Success" en Trade Kills puede significar que el jugador ceba a sus compañeros o que sus compañeros no saben jugar para el refrag. Sé delicado con esta observación. Un alto porcentaje en ambas es señal de un excelente juego en equipo.
    -   **Ventaja/Desventaja (5v4 vs 4v5):** Un % alto en 5v4 es esperado. Un % bajo (< 60%) es una señal de alarma. Un % alto en 4v5 (> 25%) indica una gran capacidad de remontada.
-   **Informe:** Presenta un resumen claro con "Puntos Fuertes" y "Áreas de Mejora".
-   **Plan de acción:** Ofrece una lista de 2-3 ejercicios o enfoques concretos, inspirados en las estrategias profesionales.

**Flujo de Análisis de Replay (Texto):**
-   **Datos de entrada:** Recibirás un texto con el resumen de rondas de una partida.
-   **Análisis Táctico:** Usa tu base de conocimientos para analizar el *flujo* de la partida.
    -   **Identifica Patrones:** ¿El jugador muere a menudo por no tener apoyo? ¿Intenta jugadas heroicas en desventaja? Compara sus decisiones con el principio de "Jame Time" o la agresividad de "donk".
    -   **Analiza Decisiones:** Evalúa si el jugador juega para sí mismo o para el equipo. Un push en solitario puede ser un error, pero si fue para crear una distracción (estilo 'ropz'), puede ser un acierto.
    -   **Ofrece Consejos Concretos y Profesionales:** No digas "juega mejor en medio". Di "En la ronda 7, tu agresividad en medio fue similar a la que usa 'donk' para abrir el mapa, pero te faltó una flash de tu compañero. La próxima vez, pide apoyo para que tu entrada sea más segura, como hace Team Spirit".
-   **Informe de Replay:** Estructura tu respuesta con: Aciertos Tácticos, Errores Tácticos a Corregir, y un Plan de Mejora Táctica con referencias a jugadas o estilos profesionales.`;let tt;function ua(o){return new Promise((n,e)=>{const t=new FileReader;t.onload=()=>{if(typeof t.result!="string")return e(new Error("Failed to read file as data URL."));const s=t.result.split(",")[1];if(!s)return e(new Error("Failed to extract base64 data from file."));n({inlineData:{data:s,mimeType:o.type}})},t.onerror=s=>e(s),t.readAsDataURL(o)})}function x(o,n){const e=document.createElement("div");return e.classList.add("message",`${o}-message`),o==="model"?e.innerHTML=de.parse(n,{breaks:!0,gfm:!0}):e.innerHTML=n,$.appendChild(e),$.scrollTop=$.scrollHeight,e}function k(o){na.style.display=o?"flex":"none",te.disabled=o,ea.disabled=o,jn.disabled=o,Qn.disabled=o,o||te.focus()}async function le(o,n){k(!0),Se.classList.add("hidden"),x("user",n||o);try{const t={message:o},s=await tt.sendMessageStream(t);let l="";const a=x("model","...");for await(const u of s)l+=u.text,a.innerHTML=de.parse(l+"▌",{breaks:!0,gfm:!0}),$.scrollTop=$.scrollHeight;a.innerHTML=de.parse(l,{breaks:!0,gfm:!0}),O+=2,O===4&&!Ae?(Ie.showModal(),Ae=!0,localStorage.setItem("initialDonationShown","true")):O>=10&&O%10===0&&Se.classList.remove("hidden")}catch(t){console.error(t);const s=t instanceof Error?t.message:"An unknown error occurred.";x("model",`**Error:** ${s}`)}finally{k(!1)}}async function da(o){o.preventDefault();const n=te.value.trim();n&&(te.value="",await le(n))}function U(o,n,e){const t=[];return e.forEach(s=>{var a,u;const l=(a=o.get(s))==null?void 0:a.toString();if(l){const c=((u=document.querySelector(`label[for="${s}"]`))==null?void 0:u.textContent)||s;t.push(`- **${c}**: ${l}`)}}),t.length>0?`### ${n}
${t.join(`
`)}
`:""}async function ca(o){o.preventDefault();const n=new FormData(Ee);let e=`Por favor, realiza un análisis de experto sobre mi rendimiento en las últimas 30 partidas de CS2, basándote en los siguientes datos de Leetify. Dame un plan de acción concreto y profesional.

`;if(e+=U(n,"Estadísticas Generales",["win_rate","leetify_rating","hltv_rating","kd_ratio","avg_kills","avg_deaths","adr","hs_kill_percent","rounds_survived","best_weapon","rounds_4v5_won","rounds_5v4_won"]),e+=U(n,"Multikills (Totales)",["multikill_2k","multikill_3k","multikill_4k","multikill_5k"]),e+=U(n,"Duelos de Apertura",["opening_attempts","opening_success","opening_traded","opening_rating"]),e+=U(n,"Clutching",["clutch_win_rate","clutch_1v1"]),e+=U(n,"Traded Deaths (Cuando muero)",["tradeable_deaths","traded_deaths_attempts","traded_deaths_success"]),e+=U(n,"Trade Kills (Cuando un compañero muere)",["trade_kills_opps","trade_kills_attempts","trade_kills_success"]),e.split(`
`).length<=3){x("model","Por favor, introduce al menos una estadística para analizar.");return}Y.close(),Ee.reset(),await le(e)}async function fa(o){var e;o.preventDefault();const n=(e=ve.files)==null?void 0:e[0];if(!n){x("model","Por favor, selecciona un archivo de imagen primero.");return}Y.close(),k(!0);try{const t=await ua(n),s={text:"Analiza mi rendimiento basándote en esta captura de pantalla de mis estadísticas. Identifica mis puntos fuertes, débiles y dame un plan de entrenamiento personalizado y detallado usando tu base de conocimientos de nivel profesional."},l=new FileReader;l.onload=async a=>{var d;const c=`<p>Analizando esta captura de pantalla:</p><img src="${(d=a.target)==null?void 0:d.result}" alt="Uploaded stats" class="message-image">`;await le([s,t],c)},l.readAsDataURL(n)}catch(t){console.error("Error processing screenshot:",t),x("model","**Error:** No se pudo procesar la imagen. Inténtalo de nuevo."),k(!1)}finally{et.reset(),Q.classList.add("hidden"),_e.textContent="Ningún archivo seleccionado"}}async function pa(o){o.preventDefault();const n=ta.value.trim();if(!n){x("model","Por favor, pega el resumen de tu partida en el área de texto.");return}const e=`Usa tu base de conocimientos de Majors para realizar un análisis táctico de nivel profesional del siguiente resumen de partida de CS2. Identifica mis errores tácticos recurrentes, mis aciertos clave y dame un plan de entrenamiento detallado y enfocado en mejorar mis decisiones, comparando mis jugadas con las de los profesionales. Aquí están los eventos:

---
${n}
---`;Y.close(),nt.reset(),await le(e)}async function ma(){try{tt=new Ql({apiKey:"PLACEHOLDER_API_KEY"}).chats.create({model:"gemini-2.5-flash",config:{systemInstruction:aa}}),Ae=localStorage.getItem("initialDonationShown")==="true",Zn.addEventListener("submit",da),Ee.addEventListener("submit",ca),et.addEventListener("submit",fa),nt.addEventListener("submit",pa),jn.addEventListener("click",()=>Y.showModal()),Qn.addEventListener("click",()=>{window.open(jl,"_blank")}),ia.forEach(n=>{n.addEventListener("click",()=>Y.close())}),oa.addEventListener("click",n=>{var l;const t=n.target.closest(".tab-btn");if(!t)return;document.querySelectorAll(".tab-btn").forEach(a=>a.classList.remove("active")),document.querySelectorAll(".tab-panel").forEach(a=>a.classList.remove("active")),t.classList.add("active");const s=t.dataset.tab;(l=document.getElementById(s))==null||l.classList.add("active")}),ve.addEventListener("change",()=>{var e;const n=(e=ve.files)==null?void 0:e[0];n?(_e.textContent=n.name,Q.src=URL.createObjectURL(n),Q.classList.remove("hidden")):(_e.textContent="Ningún archivo seleccionado",Q.classList.add("hidden"))}),sa.addEventListener("click",()=>Ie.close()),ra.addEventListener("click",()=>Ie.close()),la.addEventListener("click",()=>Se.classList.add("hidden")),x("model","¡Hola! Soy tu **Analista de Rendimiento de CS2**. Todas las funciones son gratuitas. Haz clic en **ANALIZAR RENDIMIENTO** para empezar."),k(!1)}catch(o){console.error(o);const n=o instanceof Error?o.message:"Failed to initialize AI model.";x("model",`**Initialization Error:** ${n}`),k(!0)}}ma();
